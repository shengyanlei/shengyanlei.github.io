{
    "version": "https://jsonfeed.org/version/1",
    "title": "ç¢å¿µéšé£ â€¢ All posts by \"flink\" tag",
    "description": "äººæµ·æœªè§ä¹‹æ—¶ï¼Œæˆ‘äº¦ç‹¬è¡Œåœ¨è¿™åŸå¸‚ã€‚ æ–™å³­ï¼Œæ˜¥é†’ï¼Œé…·æš‘ï¼Œéª¤é›¨ï¼Œå¯’æ„å››èµ·ï¼Œå¤§é›å—é£ï¼Œè€Œåï¼Œå¤§é›ªï¼Œå¯’é£ï¼Œ æ–—è½¬æ˜Ÿç§»ï¼Œäººé—´å¯’æš‘ã€‚",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2024/05/17/BaiduSyncdisk/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink/flink%E7%AE%97%E5%AD%90%E6%80%BB%E7%BB%93/",
            "url": "http://example.com/2024/05/17/BaiduSyncdisk/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink/flink%E7%AE%97%E5%AD%90%E6%80%BB%E7%BB%93/",
            "title": "flinkç®—å­æ€»ç»“",
            "date_published": "2024-05-17T02:25:29.000Z",
            "content_html": "<p>å‰è¨€ï¼š Flink æä¾›äº†ä¸°å¯Œçš„ç®—å­æ¥æ–¹ä¾¿å¼€å‘è€…å¤„ç†å„ç§åº”ç”¨åœºæ™¯ã€‚</p>\n<h4 id=\"ä¸€-åŸºæœ¬è½¬æ¢ç±»ç®—å­\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€-åŸºæœ¬è½¬æ¢ç±»ç®—å­\">#</a> ä¸€ã€åŸºæœ¬è½¬æ¢ç±»ç®—å­</h4>\n<ol>\n<li>\n<h5 id=\"map\"><a class=\"markdownIt-Anchor\" href=\"#map\">#</a> Mapï¼š</h5>\n<ol>\n<li><strong>ä½œç”¨</strong>ï¼šå°†ç”¨æˆ·å®šä¹‰çš„ MapFunction å‡½æ•°åº”ç”¨äºæ•°æ®æµä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚æ•°æ®æµä¸­çš„æ¯ä¸ªå…ƒç´ å°†ä½œä¸ºè¾“å…¥å…ƒç´ è¿›å…¥ç”¨æˆ·å®šä¹‰çš„ MapFunction å‡½æ•°ï¼ŒMapFunction å‡½æ•°å°†å¯¹è¾“å…¥çš„å…ƒç´ è¿›è¡Œè½¬æ¢å¹¶äº§ç”Ÿä¸€ä¸ªç»“æœå…ƒç´ è¾“å‡ºåˆ°æ–°çš„æ•°æ®æµä¸­ã€‚</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**DataStream -&gt; DataStreamã€‚</li>\n<li>** åº”ç”¨åœºæ™¯ï¼š** è§£æå…ƒç´ ï¼Œè½¬æ¢æ•°æ®ç±»å‹ã€‚</li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n<li>\n<h5 id=\"flatmap\"><a class=\"markdownIt-Anchor\" href=\"#flatmap\">#</a> FlatMapï¼š</h5>\n<ol>\n<li>** ä½œç”¨ï¼š** å°†ç”¨æˆ·å®šä¹‰çš„ FlatMapFunction å‡½æ•°åº”ç”¨äºæ•°æ®æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ•°æ®æµä¸­çš„æ¯ä¸ªå…ƒç´ å°†ä½œä¸ºè¾“å…¥å…ƒç´ è¿›å…¥ FlatMapFunction å‡½æ•°ï¼ŒFlatMapFunction å‡½æ•°å°†å¯¹è¾“å…¥çš„å…ƒç´ è¿›è¡Œè½¬æ¢å¹¶äº§ç”Ÿ 0 ä¸ªï¼Œ1 ä¸ªï¼Œæˆ–è€…å¤šä¸ªç»“æœå…ƒç´ è¾“å‡ºåˆ°æ–°çš„æ•°æ®æµä¸­ã€‚</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**DataStream -&gt; DataStreamã€‚</li>\n<li>** åº”ç”¨åœºæ™¯ï¼š** æ‹†åˆ†ä¸éœ€è¦çš„åˆ—è¡¨å’Œæ•°ç»„ã€‚</li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n<li>\n<h5 id=\"filter\"><a class=\"markdownIt-Anchor\" href=\"#filter\">#</a> Filterï¼š</h5>\n<ol>\n<li>** ä½œç”¨ï¼š** å°†ç”¨æˆ·å®šä¹‰çš„ FilterFunction å‡½æ•°åº”ç”¨äºæ•°æ®æµä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚æ•°æ®æµä¸­çš„æ¯ä¸ªå…ƒç´ å°†ä½œä¸ºè¾“å…¥å…ƒç´ è¿›å…¥ FilterFunction å‡½æ•°ï¼ŒFilterFunction å‡½æ•°å¯¹è¾“å…¥çš„å…ƒç´ è¿›è¡Œåˆ¤æ–­æ¥å†³å®šä¿ç•™è¯¥å…ƒç´ è¿˜æ˜¯ä¸¢å¼ƒè¯¥å…ƒç´ ï¼Œè¿”å› true ä»£è¡¨ä¿ç•™ï¼Œè¿”å› false ä»£è¡¨ä¸¢å¼ƒã€‚</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**DataStream -&gt; DataStreamã€‚</li>\n<li>** åº”ç”¨åœºæ™¯ï¼š** æ•°æ®å»é‡</li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n<li>\n<h5 id=\"keyby\"><a class=\"markdownIt-Anchor\" href=\"#keyby\">#</a> KeyByï¼š</h5>\n<ol>\n<li>** ä½œç”¨ï¼š**KeyBy æ“ä½œç¬¦çš„æ‰§è¡Œé€»è¾‘æ˜¯å°†ä¸€ä¸ªæ•°æ®æµåˆ†æˆä¸ç›¸äº¤çš„æµåˆ†åŒºï¼ˆåˆ†åŒºæ•°é‡å’Œå¹¶è¡Œåº¦ä¸€è‡´ï¼‰ï¼Œæ‰€æœ‰å…·æœ‰ç›¸åŒ Key çš„å…ƒç´ éƒ½è¢«åˆ†é…åˆ°ç›¸åŒçš„æµåˆ†åŒºï¼Œåœ¨ keyby æ“ä½œç¬¦å†…éƒ¨é€šè¿‡æ•£åˆ—ç®—æ³•æ¥åˆ’åˆ†å…ƒç´ åˆ°å¯¹åº”çš„æµåˆ†åŒºã€‚</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**DataStream -&gt; KeyedStreamã€‚</li>\n<li>** åº”ç”¨åœºæ™¯ï¼š** èšåˆã€çŠ¶æ€ç®¡ç†ã€çª—å£æ“ä½œ</li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n<li>\n<h5 id=\"reduce\"><a class=\"markdownIt-Anchor\" href=\"#reduce\">#</a> Reduceï¼š</h5>\n<ol>\n<li>** ä½œç”¨ï¼š**Reduce æ“ä½œç¬¦åº”ç”¨ç”¨æˆ·å®šä¹‰çš„ ReduceFunction å‡½æ•°å°† KeyedStream ä¸­å…·æœ‰ç›¸åŒ Key å…ƒç´ åˆå¹¶ä¸ºå•ä¸ªå€¼ï¼Œè€Œä¸”æ€»æ˜¯å°†ä¸¤ä¸ªå…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªå…ƒç´ ï¼Œå…·ä½“ç»†èŠ‚ä¸ºå°†ä¸Šä¸€ä¸ªåˆå¹¶è¿‡çš„å€¼å’Œå½“å‰è¾“å…¥çš„å…ƒç´ ç»“åˆï¼Œäº§ç”Ÿæ–°çš„å€¼å‘å‡ºã€‚Reduce æ“ä½œç¬¦å°† ReduceFunction å‡½æ•°è¿ç»­åº”ç”¨äºåŒä¸€ä¸ªç»„çš„æ‰€æœ‰å€¼ï¼Œç›´åˆ°ä»…å‰©ä¸€ä¸ªå€¼ä¸ºæ­¢ã€‚</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**KeyedStream -&gt; DataStreamã€‚</li>\n<li>** åº”ç”¨åœºæ™¯ï¼š** èšåˆè®¡ç®—</li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n</ol>\n<h4 id=\"äºŒ-èšåˆç®—å­\"><a class=\"markdownIt-Anchor\" href=\"#äºŒ-èšåˆç®—å­\">#</a> äºŒã€èšåˆç®—å­</h4>\n<ol>\n<li>\n<h5 id=\"aggregations\"><a class=\"markdownIt-Anchor\" href=\"#aggregations\">#</a> aggregations</h5>\n<ol>\n<li>\n<p>** ä½œç”¨ï¼š** æä¾›ä¸€ç³»åˆ—å†…ç½®çš„èšåˆé€»è¾‘ï¼Œå¯ä»¥å¯¹ KeyStream ä¸­å…·æœ‰ç›¸åŒ Key çš„å…ƒç´ è¿›è¡Œæ±‚å’Œï¼Œæ±‚æœ€å¤§å€¼æˆ–æœ€å°å€¼ç­‰ã€‚æä¾›ä¸¤ç§æ–¹å¼å¯¹å…·æœ‰ç›¸åŒ key çš„å…ƒç´ è¿›è¡Œèšåˆè®¡ç®—ã€‚å¯¹äº POJO ç±»å‹çš„å…ƒç´ å¯ä»¥é€šè¿‡æŒ‡å®šå­—æ®µåç§°æ¥æŒ‡å®šèšåˆå­—æ®µï¼Œå¯¹äºå…ƒç»„ç±»å‹çš„å…ƒç´ å¯ä»¥é€šè¿‡æŒ‡å®šå…ƒç´ çš„ç´¢å¼•æ¥æŒ‡å®šèšåˆå­—æ®µã€‚</p>\n</li>\n<li>\n<p>** æ•°æ®æµè½¬æ¢ï¼š**KeyedStream-&gt; DataStream</p>\n</li>\n<li>\n<p><strong>åˆ†ç±»ï¼š</strong></p>\n<ol>\n<li>**sumï¼š** è¿”å›åŒä¸€ä¸ª Key åˆ†ç»„ä¸‹æŒ‡å®šå­—æ®µçš„å’Œã€‚</li>\n<li>**minï¼š** è¿”å›åŒä¸€ä¸ª key åˆ†ç»„ä¸‹æŒ‡å®šå­—æ®µçš„æœ€å°å€¼ã€‚</li>\n<li>**minbyï¼š** è¿”å›åŒä¸€ä¸ª key åˆ†ç»„ä¸‹æŒ‡å®šå­—æ®µä¸­å…·æœ‰æœ€å°å€¼çš„å…ƒç´ ã€‚</li>\n<li>**maxï¼š** è¿”å›åŒä¸€ä¸ª key åˆ†ç»„ä¸‹æŒ‡å®šå­—æ®µçš„æœ€å¤§å€¼ã€‚</li>\n<li>**maxbyï¼š** è¿”å›åŒä¸€ä¸ª key åˆ†ç»„ä¸‹æŒ‡å®šå­—æ®µä¸­å…·æœ‰æœ€å¤§å€¼çš„å…ƒç´ ã€‚</li>\n</ol>\n<p><font color=\"red\">æ³¨ï¼šç±»ä¼¼å…³ç³»å‹æ•°æ®çš„ SQL è¯­æ³•ï¼ŒMin æ˜¯å–å­—æ®µçš„æœ€å°å€¼ï¼ŒMinBy æ˜¯å–å­—æ®µæœ€å°çš„ä¸€æ•´è¡Œæ•°æ®ï¼ˆmax åŒç†ï¼‰ã€‚</font></p>\n</li>\n<li>\n<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>\n</li>\n<li>\n<p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p>\n</li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n</ol>\n<h4 id=\"ä¸‰-æ•°æ®æµæ“ä½œç®—å­\"><a class=\"markdownIt-Anchor\" href=\"#ä¸‰-æ•°æ®æµæ“ä½œç®—å­\">#</a> ä¸‰ã€æ•°æ®æµæ“ä½œç®—å­</h4>\n<ol>\n<li>\n<h5 id=\"keybyå‰é¢ä»‹ç»è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#keybyå‰é¢ä»‹ç»è¿‡\">#</a> keyBYï¼ˆå‰é¢ä»‹ç»è¿‡ï¼‰</h5>\n</li>\n<li>\n<p><strong>Split å’Œ Selectï¼ˆåç»­ç‰ˆæœ¬åˆ é™¤ï¼Œä½œè€…ä½¿ç”¨ç‰ˆæœ¬ä¸º 1.14ï¼‰ï¼š</strong></p>\n<ol>\n<li>\n<p>** ä½œç”¨ï¼š** è¿™ä¸¤ä¸ªæ“ä½œç¬¦é€šå¸¸æ˜¯ç»„åˆä½¿ç”¨çš„ï¼ŒSplit æ“ä½œç¬¦æ ¹æ®ç”¨æˆ·å®šä¹‰çš„æ ‡å‡†å°†æ•°æ®æµæ‹†åˆ†ä¸ºä¸¤ä¸ªæˆ–è€…æ›´å¤šçš„æ•°æ®æµï¼ŒSelect æ“ä½œç¬¦æ ¹æ®ç”¨æˆ·å®šä¹‰çš„æ ‡å‡†è·å–å¯¹åº”çš„æ•°æ®æµï¼Œä»¥ä¾¿åœ¨è·å–çš„æ•°æ®æµä¸­æ‰§è¡Œåç»­çš„è½¬æ¢æ“ä½œã€‚</p>\n</li>\n<li>\n<p>** æ•°æ®æµè½¬æ¢ï¼š**splitï¼šDataStream -&gt; SplitStream <br> Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â selectï¼šSplitStream -&gt; DataStream</p>\n</li>\n<li>\n<p>** åº”ç”¨åœºæ™¯ï¼š** åˆ‡åˆ†æ•°æ®æµï¼Œè·å–æ•°æ®æµ</p>\n</li>\n<li>\n<p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p>\n</li>\n</ol>\n<pre><code class=\"language-java\">   \n</code></pre>\n</li>\n<li>\n<h5 id=\"project\"><a class=\"markdownIt-Anchor\" href=\"#project\">#</a> Project</h5>\n<ol>\n<li>** ä½œç”¨ï¼š**Project æ“ä½œç¬¦ä½œç”¨åœ¨å…ƒç´ çš„æ•°æ®ç±»å‹æ˜¯å…ƒç»„çš„æ•°æ®æµä¸­ï¼Œå®ƒæ ¹æ®æŒ‡å®šçš„ç´¢å¼•ä»å…ƒç»„ä¸­é€‰æ‹©å¯¹åº”çš„å­—æ®µç»„æˆä¸€ä¸ªå­é›†ã€‚è¯¥æ“ä½œç¬¦çš„å‚æ•°æ˜¯ä¸€ä¸ªå˜é•¿å‚æ•°ï¼Œç±»å‹ä¸º Intã€‚å‚æ•°æŒ‡å®šä¿ç•™çš„è¾“å…¥å…ƒç»„çš„å­—æ®µç´¢å¼•ï¼Œè¾“å‡ºå…ƒç»„çš„å­—æ®µé¡ºåºä¸å­—æ®µç´¢å¼•çš„é¡ºåºç›¸å¯¹åº”ã€‚</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**DataStream -&gt;DataStream</li>\n<li>** åº”ç”¨åœºæ™¯ï¼š** æŒ‰å…ƒç»„ç´¢å¼•åˆ›å»ºæ–°æµ</li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n<li>\n<h5 id=\"union\"><a class=\"markdownIt-Anchor\" href=\"#union\">#</a> Union</h5>\n<ol>\n<li>** ä½œç”¨ï¼š**Union æ“ä½œç¬¦è´Ÿè´£å°†ä¸¤ä¸ªæˆ–è€…å¤šä¸ª<font color=\"red\">ç›¸åŒç±»å‹çš„æ•°æ®æµ</font>è¿›è¡Œåˆå¹¶æ¥åˆ›å»ºä¸€ä¸ªåŒ…å«æ•°æ®æµä¸­æ‰€æœ‰å…ƒç´ çš„æ–°æ•°æ®æµã€‚è¯¥æ“ä½œç¬¦çš„å‚æ•°æ˜¯ä¸€ä¸ªå˜é•¿å‚æ•°ï¼Œå¯ä»¥æ”¯æŒåˆå¹¶å¤šä¸ªç›¸åŒç±»å‹çš„æ•°æ®æµ.</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**DataStream -&gt; DataStream</li>\n<li>** åº”ç”¨åœºæ™¯ï¼š** åˆå¹¶ä¸åŒæ•°æ®æºç›¸åŒæ•°æ®ç±»å‹çš„æ•°æ®æµ</li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n<li>\n<h5 id=\"connect\"><a class=\"markdownIt-Anchor\" href=\"#connect\">#</a> Connect</h5>\n<ol>\n<li>** ä½œç”¨ï¼š** è¿æ¥ä¸¤ä¸ªä¿ç•™å…¶ç±»å‹çš„æ•°æ®æµåˆ›å»ºæ–°çš„è¿æ¥æµï¼Œä»è€Œå…è®¸è¿™ä¸¤ä¸ªæ•°æ®æµå…±äº«çŠ¶æ€ã€‚</li>\n<li>** æ•°æ®æµè½¬åŒ–ï¼š**DataStream+DataStream -&gt; ConnectedStream</li>\n<li><strong>åº”ç”¨åœºæ™¯ï¼š</strong></li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n<li>\n<h5 id=\"comapcoflatmap\"><a class=\"markdownIt-Anchor\" href=\"#comapcoflatmap\">#</a> CoMap,CoFlatMap</h5>\n<ol>\n<li><strong>ä½œç”¨ï¼š</strong>\n<ol>\n<li>CoMapï¼šåœ¨ connectStream ä¸­ä½¿ç”¨ Map æ“ä½œç¬¦å°†ç”¨æˆ·å®šä¹‰çš„ CoMapFunction å‡½æ•°åº”ç”¨äº ConnectedStream ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚æ•°æ®æµä¸­çš„æ¯ä¸ªå…ƒç´ å°†ä½œä¸ºè¾“å…¥å…ƒç´ è¿›å…¥ CoMapFunction å‡½æ•°ï¼Œå¯¹è¾“å…¥çš„å…ƒç´ è¿›è¡Œè½¬æ¢å¹¶äº§ç”Ÿä¸€ä¸ªç»“æœå…ƒç´ è¾“å‡ºåˆ°æ–°çš„æ•°æ®æµä¸­ã€‚CoMapFunction å‡½æ•°æä¾›äº† map1ï¼Œmap2 ä¸¤ç§è½¬æ¢æ–¹å¼åˆ†åˆ«å¤„ç† connectStream çš„ä¸¤ä¸ªä¸åŒç±»å‹çš„æ•°æ®æµã€‚</li>\n<li>CoFlatMapï¼šåœ¨ connectStream ä¸­ä½¿ç”¨ FlatMap æ“ä½œç¬¦å°†ç”¨æˆ·å®šä¹‰çš„ CoFlatMapFunction å‡½æ•°åº”ç”¨äº ConnectedStream ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚æ•°æ®æµä¸­çš„æ¯ä¸ªå…ƒç´ å°†ä½œä¸ºè¾“å…¥å…ƒç´ è¿›å…¥ CoMapFunction å‡½æ•°ï¼Œå¯¹è¾“å…¥çš„å…ƒç´ è¿›è¡Œè½¬æ¢å¹¶äº§ç”Ÿ 0 ä¸ªï¼Œ1 ä¸ªï¼Œæˆ–å¤šä¸ªç»“æœå…ƒç´ è¾“å‡ºåˆ°æ–°çš„æ•°æ®æµä¸­ã€‚CoFlatMapFunction å‡½æ•°æä¾›äº† flatmap1ï¼Œflatmap2 ä¸¤ç§è½¬æ¢æ–¹å¼åˆ†åˆ«å¤„ç† connectStream çš„ä¸¤ä¸ªä¸åŒç±»å‹çš„æ•°æ®æµã€‚</li>\n</ol>\n</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**ConnectedStream -&gt; DataStream</li>\n<li><strong>åº”ç”¨åœºæ™¯ï¼š</strong></li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n<li>\n<h5 id=\"iterate\"><a class=\"markdownIt-Anchor\" href=\"#iterate\">#</a> Iterate</h5>\n<ol>\n<li>** ä½œç”¨ï¼š** æµå¤„ç†ç¨‹åºçš„è¿­ä»£è®¡ç®—å®ç°äº†ä¸€ä¸ª Step å‡½æ•°å¹¶å°†å…¶åµŒå…¥ IterativeStream ç±»å‹çš„æ•°æ®æµï¼Œç”±äºæµå¤„ç†ç¨‹åºå¯èƒ½æ°¸è¿œä¸ä¼šå®Œæˆï¼Œæ‰€ä»¥æ²¡æœ‰æœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚ç›¸åéœ€è¦å¼€å‘è€…æŒ‡å®šæ•°æ®æµçš„é‚£ä¸€éƒ¨åˆ†è¢«åé¦ˆå›è¿­ä»£æ“ä½œä¸­ï¼Œä»¥åŠé‚£ä¸€éƒ¨åˆ†ä½¿ç”¨ split æ“ä½œç¬¦æˆ– filter æ“ä½œç¬¦è½¬å‘åˆ°ä¸‹æ¸¸æ•°æ®æµã€‚è¿­ä»£æ“ä½œå°†ä¸€ä¸ªæ“ä½œç¬¦çš„è¾“å‡ºé‡å®šå‘åˆ°æŸä¸ªå…ˆå‰çš„æ“ä½œç¬¦ï¼Œåœ¨æ•°æ®æµä¸­åˆ›å»º â€œåé¦ˆâ€ å¾ªç¯ã€‚</li>\n<li>** æ•°æ®æµè½¬æ¢ï¼š**DataStream -&gt; IterativeStream -&gt;DataStream</li>\n<li>** åº”ç”¨åœºæ™¯ï¼š** æ›´æ–°æ¨¡å‹ç®—æ³•</li>\n<li><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li>\n</ol>\n<pre><code class=\"language-java\">\n</code></pre>\n</li>\n</ol>\n<h4 id=\"å››-çª—å£ç®—å­\"><a class=\"markdownIt-Anchor\" href=\"#å››-çª—å£ç®—å­\">#</a> å››ã€çª—å£ç®—å­</h4>\n<p>æœ‰å…³çª—å£çš„ä»‹ç»è¯·å‚è€ƒæ–‡ç« <a href=\"\" style=\"display: inline;white-space: nowrap;\">Flink çš„çª—å£</a></p>\n<h5 id=\"6ä»£ç ç¤ºä¾‹\"><a class=\"markdownIt-Anchor\" href=\"#6ä»£ç ç¤ºä¾‹\">#</a> 6. ä»£ç ç¤ºä¾‹</h5>\n<ol>\n<li>è‡ªå®šä¹‰æ•°æ®æº (1 ç§’å‘é€ä¸€æ¡æ•°æ®)</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>shyl<span class=\"token punctuation\">.</span>bean</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">.</span>tuple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Tuple3</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DataStreamSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamExecutionEnvironment</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SourceFunction</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>slf4j<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Logger</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>slf4j<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LoggerFactory</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SimpleDateFormat</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Date</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SourceForWindow</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">SourceFunction</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Tuple3</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Logger</span> <span class=\"token constant\">LOG</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">LoggerFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SourceForWindow</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">volatile</span> <span class=\"token keyword\">boolean</span> isRunning <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">// å‘é€å…ƒç´ é—´éš”æ—¶é—´</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> sleepTime<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token constant\">WORDS</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token string\">\"shyl\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token string\">\"shyl\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token string\">\"shyl\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token string\">\"shyl\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token string\">\"shyl\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token string\">\"java\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token string\">\"flink\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token string\">\"flink\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token string\">\"flink\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token string\">\"shyl\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token string\">\"shyl\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token string\">\"hadoop\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token string\">\"hadoop\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token string\">\"spark\"</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SourceForWindow</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> sleepTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sleepTime <span class=\"token operator\">=</span> sleepTime<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SourceContext</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Tuple3</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> ctx<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">int</span> count <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>isRunning<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token class-name\">String</span> word <span class=\"token operator\">=</span> <span class=\"token constant\">WORDS</span><span class=\"token punctuation\">[</span>count <span class=\"token operator\">%</span> <span class=\"token constant\">WORDS</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token class-name\">String</span> time <span class=\"token operator\">=</span> <span class=\"token function\">getHHmmss</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token class-name\">Tuple3</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> tuple2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Tuple3</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            ctx<span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span>tuple2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token constant\">LOG</span><span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"send data :\"</span> <span class=\"token operator\">+</span> tuple2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span>sleepTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            count<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        isRunning <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getHHmmss</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> time<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token class-name\">SimpleDateFormat</span> sdf <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDateFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> sdf<span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"æ—¶é—´:\"</span> <span class=\"token operator\">+</span> str<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"https://note.youdao.com/yws/api/personal/file/WEB784f05b36e6fdd6006e67f3f701aa53b?method=download&amp;shareKey=07beb93234958c59db0138ad9d34bbdf\" alt=\"æ•°æ®æºæˆªå›¾\"></p>\n<ol start=\"2\">\n<li></li>\n</ol>\n<hr>\n<p class=\"note note-primary\">å¯Œå‡½æ•°:æ˜¯Flinkçš„é«˜çº§æ“ä½œç¬¦ï¼Œå°†RichFunctionæ¥å£æˆä¸ºå¯Œå‡½æ•°ã€‚æ‰€æœ‰çš„æ“ä½œç¬¦ä¸Šåº”ç”¨çš„å‡½æ•°éƒ½æœ‰å¯Œå‡½æ•°ç‰ˆæœ¬ï¼Œåªéœ€è¦åœ¨å„ç§å‡½æ•°ç±»åå‰é¢åŠ ä¸ŠRichå‰ç¼€å³å¯ã€‚å¯Œå‡½æ•°åœ¨åŸºæœ¬å‡½æ•°æä¾›çš„æ“ä½œæ–¹æ³•ä¹‹å¤–é¢å¤–æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ–¹ä¾¿å¼€å‘è€…ä¸°å¯Œè‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ã€‚<br>\n1.ğŸ”´void open():æ‰§è¡ŒåŸºæœ¬æ“ä½œæ–¹æ³•å‰çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå®ƒåœ¨åŸºæœ¬çš„æ“ä½œæ–¹æ³•ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨ï¼Œå› æ­¤é€‚åˆåœ¨æ–¹æ³•ä¸­è¿›è¡Œç¼–å†™åˆå§‹åŒ–èµ„æºç­‰ä¸€æ¬¡æ€§è®¾ç½®å·¥ä½œã€‚è¯¥æ–¹æ³•å¯èƒ½ä¼šè½¬å‘è¿è¡Œæ—¶æ•è·çš„å¼‚å¸¸ï¼Œå½“è¿è¡Œæ—¶æ•è·å¼‚å¸¸æ—¶ï¼Œå®ƒå°†ä¸­æ­¢ä»»åŠ¡ï¼Œå¹¶æ ¹æ®æŒ‡å®šçš„é‡å¯ç­–ç•¥å†³å®šæ˜¯å¦é‡è¯•ä»»åŠ¡ã€‚<br>\n2.ğŸ”´void close():åœ¨æœ€åä¸€æ¬¡è°ƒç”¨åŸºæœ¬çš„æ“ä½œæ–¹æ³•ä¹‹åè°ƒç”¨å®ƒï¼Œæ¢å¥è¯è¯´å°±æ˜¯åœ¨Flinkç¨‹åºç»“æŸå‰è¢«è°ƒç”¨ï¼Œä¸»è¦ç”¨äºé‡Šæ”¾ç¨‹åºä¸­çš„èµ„æºï¼Œè¯¥æ–¹æ³•ä¹Ÿå¯èƒ½è½¬å‘è¿è¡Œæ—¶æ•è·çš„å¼‚å¸¸ã€‚<br>\n3.ğŸ”´RuntimeContext getRuntimeContext():è·å–æœ‰å…³ç”¨æˆ·å®šä¹‰çš„å‡½æ•°è¿è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾‹å¦‚å‡½æ•°çš„å¹¶è¡Œåº¦ï¼Œå‡½æ•°çš„å­ä»»åŠ¡ç´¢å¼•æˆ–è€…æ‰§è¡Œå‡½æ•°çš„ä»»åŠ¡åç§°ã€‚RuntimeContextè¿˜æä¾›å¯¹ç´¯åŠ å™¨ï¼Œåˆ†å¸ƒå¼ç¼“å­˜ï¼Œè®¡æ•°å™¨ï¼Œå½“å‰é…ç½®ä¿¡æ¯ï¼Œ<font color='red'>çŠ¶æ€</font>ç­‰å¯¹è±¡çš„è®¿é—®ã€‚<br>\n4.IterationRuntimeContext getIterationRuntimeContext():è·å–RuntimeContextçš„ä¸“ç”¨ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å…·æœ‰æœ‰å…³æ‰§è¡Œå‡½æ•°è¿­ä»£çš„å…¶ä»–ä¿¡æ¯ã€‚ä»…å½“å‡½æ•°æ˜¯è¿­ä»£çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œæ­¤IterationRuntimeContextæ‰å¯ç”¨ï¼Œå¦åˆ™è°ƒç”¨æ­¤æ–¹æ³•å°†å¼•å‘å¼‚å¸¸ã€‚<br>\n5.void setRuntimeContext(RuntimeContext t):è®¾ç½®å‡½æ•°è¿è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ï¼Œå°†ç”¨æˆ·å®šä¹‰çš„å‡½æ•°åº”ç”¨äºæ“ä½œç¬¦çš„å¹¶è¡Œå®ä¾‹æ—¶ç”±Flinkæ¡†æ¶è‡ªåŠ¨è°ƒç”¨ã€‚</p>\n",
            "tags": [
                "å¤§æ•°æ®",
                "Flink"
            ]
        },
        {
            "id": "http://example.com/2023/12/14/BaiduSyncdisk/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink/Flink%E7%9A%84%E4%B8%8D%E5%90%8Csource/",
            "url": "http://example.com/2023/12/14/BaiduSyncdisk/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink/Flink%E7%9A%84%E4%B8%8D%E5%90%8Csource/",
            "title": "Flinkçš„ä¸åŒsource",
            "date_published": "2023-12-14T07:31:33.000Z",
            "content_html": "<ol>\n<li><strong>Elements</strong></li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DataStreamSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SingleOutputStreamOperator</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamExecutionEnvironment</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> elements <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token class-name\">StreamExecutionEnvironment</span> env <span class=\"token operator\">=</span> <span class=\"token class-name\">StreamExecutionEnvironment</span><span class=\"token punctuation\">.</span><span class=\"token function\">getExecutionEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        env<span class=\"token punctuation\">.</span><span class=\"token function\">setParallelism</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">DataStreamSource</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> listSource <span class=\"token operator\">=</span> env<span class=\"token punctuation\">.</span><span class=\"token function\">fromElements</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token class-name\">SingleOutputStreamOperator</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">=</span> listSource<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-></span> i <span class=\"token operator\">+</span> i <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        map<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        env<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"from_Elements\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ol start=\"2\">\n<li><strong>TextFile</strong></li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>shyl<span class=\"token punctuation\">.</span>source</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">FlatMapFunction</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">.</span>tuple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Tuple2</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>configuration<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DataStreamSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SingleOutputStreamOperator</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamExecutionEnvironment</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Collector</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TextFile</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token class-name\">StreamExecutionEnvironment</span> env <span class=\"token operator\">=</span> <span class=\"token class-name\">StreamExecutionEnvironment</span><span class=\"token punctuation\">.</span><span class=\"token function\">createLocalEnvironmentWithWebUI</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\">DataStreamSource</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> source <span class=\"token operator\">=</span> env<span class=\"token punctuation\">.</span><span class=\"token function\">readTextFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"F:\\\\BigData\\\\Flink1.4\\\\input\\\\1.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setParallelism</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token class-name\">SingleOutputStreamOperator</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Tuple2</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> flatmap <span class=\"token operator\">=</span> source<span class=\"token punctuation\">.</span><span class=\"token function\">flatMap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FlatMapFunction</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Tuple2</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">flatMap</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Collector</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Tuple2</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> collector<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> key <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s1 <span class=\"token operator\">:</span> key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                    collector<span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Tuple2</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>s1<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token class-name\">SingleOutputStreamOperator</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Tuple2</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> sum <span class=\"token operator\">=</span> flatmap<span class=\"token punctuation\">.</span><span class=\"token function\">keyBy</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        sum<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        env<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TextFile\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ol start=\"3\">\n<li><strong>socket</strong></li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>shyl<span class=\"token punctuation\">.</span>source</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MapFunction</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">.</span>tuple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Tuple2</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DataStreamSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SingleOutputStreamOperator</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamExecutionEnvironment</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> socket <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">StreamExecutionEnvironment</span> env <span class=\"token operator\">=</span> <span class=\"token class-name\">StreamExecutionEnvironment</span><span class=\"token punctuation\">.</span><span class=\"token function\">getExecutionEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">DataStreamSource</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> source <span class=\"token operator\">=</span> env<span class=\"token punctuation\">.</span><span class=\"token function\">socketTextStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"192.168.52.201\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9999</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">SingleOutputStreamOperator</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">=</span> source<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MapFunction</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Tuple2</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        map<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        env<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"new socket\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ol start=\"4\">\n<li><strong>kafka</strong></li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>shyl<span class=\"token punctuation\">.</span>source</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>eventtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WatermarkStrategy</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MapFunction</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">.</span>tuple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Tuple2</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">.</span>tuple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Tuple3</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DataStreamSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SingleOutputStreamOperator</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamExecutionEnvironment</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>connectors<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">FlinkKafkaConsumer</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>connectors<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">FlinkKafkaConsumerBase</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>serialization<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SimpleStringSchema</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Duration</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Properties</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> kafka <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token class-name\">StreamExecutionEnvironment</span> env <span class=\"token operator\">=</span> <span class=\"token class-name\">StreamExecutionEnvironment</span><span class=\"token punctuation\">.</span><span class=\"token function\">getExecutionEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">//        åˆ›å»º kafka æ•°æ®æºçš„é…ç½®</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token class-name\">Properties</span> properties <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Properties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        properties<span class=\"token punctuation\">.</span><span class=\"token function\">setProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bootstrap.servers\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"192.168.52.201:9092\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        properties<span class=\"token punctuation\">.</span><span class=\"token function\">setProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"group_id\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"kafka_source\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token comment\">// æŒ‡å®šæ¶ˆè´¹è€…è¯»å–çš„ä½ç½®</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token class-name\">FlinkKafkaConsumer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> consumer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FlinkKafkaConsumer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleStringSchema</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> properties<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        consumer<span class=\"token punctuation\">.</span><span class=\"token function\">setStartFromEarliest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// å°½å¯èƒ½ä»æœ€æ—©çš„è®°å½•å¼€å§‹</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">//        consumer.setStartFromLatest ();       // ä»æœ€æ–°çš„è®°å½•å¼€å§‹</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">//        consumer.setStartFromTimestamp (); // ä»æŒ‡å®šçš„æ—¶é—´å¼€å§‹ï¼ˆæ¯«ç§’ï¼‰</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">//        consumer.setStartFromGroupOffsets (); // é»˜è®¤çš„æ–¹æ³• ä» Kafka brokers ä¸­çš„ consumer ç»„ï¼ˆconsumer å±æ€§ä¸­çš„ group.id è®¾ç½®ï¼‰æäº¤çš„åç§»é‡ä¸­å¼€å§‹è¯»å–åˆ†åŒºã€‚ å¦‚æœæ‰¾ä¸åˆ°åˆ†åŒºçš„åç§»é‡ï¼Œé‚£ä¹ˆå°†ä¼šä½¿ç”¨é…ç½®ä¸­çš„ auto.offset.reset è®¾ç½®ã€‚</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token class-name\">DataStreamSource</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> kafkasource <span class=\"token operator\">=</span> env<span class=\"token punctuation\">.</span><span class=\"token function\">addSource</span><span class=\"token punctuation\">(</span>consumer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token class-name\">SingleOutputStreamOperator</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">=</span> kafkasource<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MapFunction</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Tuple2</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        map<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        env<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kafka_source\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ol start=\"5\">\n<li><strong>jdbc</strong>ï¼šflink æ²¡æœ‰å¯¹ mysql ç›´æ¥æä¾›æ”¯æŒ ï¼Œéœ€è¦è‡ªå®šä¹‰æ•°æ®æºã€‚</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>shyl<span class=\"token punctuation\">.</span>source</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>configuration<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RichParallelSourceFunction</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JDBCSourceFromMysql</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">RichParallelSourceFunction</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>base_dic<span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">PreparedStatement</span> ps <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Connection</span> connection <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Configuration</span> parameters<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span>parameters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        connection <span class=\"token operator\">=</span> <span class=\"token function\">getConnetion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from base_dic\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        ps <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>connection<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token function\">getRuntimeContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getJobId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>connection <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            connection<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ps <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            ps<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SourceContext</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>base_dic<span class=\"token punctuation\">></span></span> sourceContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token class-name\">ResultSet</span> resultSet <span class=\"token operator\">=</span> ps<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            base_dic basedic <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token function\">base_dic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            basedic<span class=\"token punctuation\">.</span><span class=\"token function\">setDic_code</span><span class=\"token punctuation\">(</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dic_code\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            basedic<span class=\"token punctuation\">.</span><span class=\"token function\">setDic_name</span><span class=\"token punctuation\">(</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dic_name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            basedic<span class=\"token punctuation\">.</span><span class=\"token function\">setParent_code</span><span class=\"token punctuation\">(</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"parent_code\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            basedic<span class=\"token punctuation\">.</span><span class=\"token function\">setCreate_time</span><span class=\"token punctuation\">(</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create_time\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            basedic<span class=\"token punctuation\">.</span><span class=\"token function\">setOperate_time</span><span class=\"token punctuation\">(</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"operate_time\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            sourceContext<span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span>basedic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Connection</span> <span class=\"token function\">getConnetion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token class-name\">String</span> driver <span class=\"token operator\">=</span> <span class=\"token string\">\"com.mysql.cj.jdbc.Driver\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token class-name\">String</span> url <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql://192.168.52.201:3306/gmall\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token class-name\">String</span> username <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token class-name\">String</span> password <span class=\"token operator\">=</span> <span class=\"token string\">\"1234kxmall!@#ABC\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token class-name\">Connection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            <span class=\"token class-name\">Class</span><span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                con <span class=\"token operator\">=</span> <span class=\"token class-name\">DriverManager</span><span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SQLException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ClassNotFoundException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token keyword\">return</span> con<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>â€‹\t<strong>basc_inc ç±»</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>shyl<span class=\"token punctuation\">.</span>source</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> base_dic <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> dic_code<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> dic_name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> parent_code<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> create_time<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> operate_time<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token function\">base_dic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getDic_code</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> dic_code<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setDic_code</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> dic_code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dic_code <span class=\"token operator\">=</span> dic_code<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getDic_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">return</span> dic_name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setDic_name</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> dic_name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dic_name <span class=\"token operator\">=</span> dic_name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getParent_code</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">return</span> parent_code<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setParent_code</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> parent_code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parent_code <span class=\"token operator\">=</span> parent_code<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getCreate_time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">return</span> create_time<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setCreate_time</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> create_time<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>create_time <span class=\"token operator\">=</span> create_time<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getOperate_time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">return</span> operate_time<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setOperate_time</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> operate_time<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>operate_time <span class=\"token operator\">=</span> operate_time<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"base_inc&#123;\"</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token string\">\"dic_code='\"</span> <span class=\"token operator\">+</span> dic_code <span class=\"token operator\">+</span> <span class=\"token char\">'\\''</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>                <span class=\"token string\">\", dic_name='\"</span> <span class=\"token operator\">+</span> dic_name <span class=\"token operator\">+</span> <span class=\"token char\">'\\''</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                <span class=\"token string\">\", parent_code='\"</span> <span class=\"token operator\">+</span> parent_code <span class=\"token operator\">+</span> <span class=\"token char\">'\\''</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>                <span class=\"token string\">\", create_time='\"</span> <span class=\"token operator\">+</span> create_time <span class=\"token operator\">+</span> <span class=\"token char\">'\\''</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>                <span class=\"token string\">\", operate_time='\"</span> <span class=\"token operator\">+</span> operate_time <span class=\"token operator\">+</span> <span class=\"token char\">'\\''</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                <span class=\"token char\">'&#125;'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>â€‹\t<strong>jdbcSource</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>shyl<span class=\"token punctuation\">.</span>source</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MapFunction</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DataStreamSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>datastream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SingleOutputStreamOperator</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>flink<span class=\"token punctuation\">.</span>streaming<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamExecutionEnvironment</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JDBC</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">StreamExecutionEnvironment</span> env <span class=\"token operator\">=</span> <span class=\"token class-name\">StreamExecutionEnvironment</span><span class=\"token punctuation\">.</span><span class=\"token function\">getExecutionEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        env<span class=\"token punctuation\">.</span><span class=\"token function\">setParallelism</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">DataStreamSource</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>base_dic<span class=\"token punctuation\">></span></span> mysqlSource <span class=\"token operator\">=</span> env<span class=\"token punctuation\">.</span><span class=\"token function\">addSource</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">JDBCSourceFromMysql</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token class-name\">SingleOutputStreamOperator</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">=</span> mysqlSource<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MapFunction</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>base_dic<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">map</span><span class=\"token punctuation\">(</span>base_dic value<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        map<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        env<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mysql_source\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"å¤‡æ³¨\"><a class=\"markdownIt-Anchor\" href=\"#å¤‡æ³¨\">#</a> å¤‡æ³¨</h3>\n<p>ä»¥ flink1.4.4 ç‰ˆæœ¬ä¸ºä¾‹ï¼Œä»¥ä¸‹æ˜¯ pom æ–‡ä»¶</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token comment\">&lt;!-- https://mvnrepository.com/artifact/org.apache.flink/flink-clients --></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.flink<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>flink-clients_2.12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.14.4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">&lt;!-- https://mvnrepository.com/artifact/org.apache.flink/flink-streaming-java --></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.flink<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>flink-streaming-java_2.12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.14.4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">&lt;!--            &lt;scope>provided&lt;/scope>--></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">&lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api --></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.slf4j<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>slf4j-api<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.7.12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token comment\">&lt;!-- https://mvnrepository.com/artifact/org.apache.flink/flink-runtime-web --></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.flink<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>flink-runtime-web_2.12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.14.4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">&lt;!--            &lt;scope>test&lt;/scope>--></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.flink<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>flink-connector-kafka_2.11<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.14.4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token comment\">&lt;!-- https://mvnrepository.com/artifact/org.apache.flink/flink-connector-jdbc --></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.flink<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>flink-connector-jdbc_2.12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.14.4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\">&lt;!--            &lt;scope>provided&lt;/scope>--></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token comment\">&lt;!-- https://mvnrepository.com/artifact/com.mysql/mysql-connector-j --></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.mysql<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mysql-connector-j<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>8.0.31<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure>",
            "tags": [
                "å¤§æ•°æ®",
                "Flink"
            ]
        },
        {
            "id": "http://example.com/2023/12/06/BaiduSyncdisk/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink/Flink%E5%AD%A6%E4%B9%A0-%E4%B8%80/",
            "url": "http://example.com/2023/12/06/BaiduSyncdisk/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink/Flink%E5%AD%A6%E4%B9%A0-%E4%B8%80/",
            "title": "Flinkå­¦ä¹ (ä¸€)",
            "date_published": "2023-12-06T03:36:08.000Z",
            "content_html": "<h3 id=\"ä¸€-flinkç›¸å…³åè¯è§£æ\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€-flinkç›¸å…³åè¯è§£æ\">#</a> ä¸€ã€Flink ç›¸å…³åè¯è§£æ</h3>\n<ol>\n<li>DataStream API</li>\n<li>DataSet API</li>\n<li></li>\n</ol>\n<h3 id=\"äºŒ-flinkç¨‹åºå‰–æ\"><a class=\"markdownIt-Anchor\" href=\"#äºŒ-flinkç¨‹åºå‰–æ\">#</a> äºŒã€FLink ç¨‹åºå‰–æ</h3>\n<p>Flink ç¨‹åºçœ‹èµ·æ¥åƒæ˜¯è½¬æ¢çš„å¸¸è§„ç¨‹åºã€‚æ¯ç¨‹åºç”±ç›¸åŒçš„åŸºæœ¬éƒ¨åˆ†ç»„æˆï¼š <code>DataStreams</code></p>\n<ol>\n<li>è·å–æ‰§è¡Œç¯å¢ƒ ï¼Œ <code>execution environment</code></li>\n<li>åŠ è½½ / åˆ›å»ºåˆå§‹æ•°æ®ï¼Œ</li>\n<li>æŒ‡å®šæ­¤æ•°æ®çš„è½¬æ¢ï¼Œ</li>\n<li>æŒ‡å®šè®¡ç®—ç»“æœçš„æ”¾ç½®ä½ç½®ï¼Œ</li>\n<li>è§¦å‘ç¨‹åºæ‰§è¡Œ</li>\n</ol>\n<p><em>æ‰§è¡Œç¯å¢ƒæ–¹æ³•ï¼š</em></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">getExecutionEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">createLocalEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">createRemoteEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> host<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> port<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> jarFiles<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><em>æ•°æ®æºï¼š</em></p>\n<p>åŸºäºæ–‡ä»¶ï¼š</p>\n<ul>\n<li>\n<p><code>readTextFile(path)</code> - é€è¡Œè¯»å–æ–‡æœ¬æ–‡ä»¶ï¼Œå³éµå®ˆè§„èŒƒçš„æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚``</p>\n</li>\n<li>\n<p><code>readFile(fileInputFormat, path)</code> - æ ¹æ®æŒ‡å®šçš„æ–‡ä»¶è¾“å…¥æ ¼å¼è¯»å–ï¼ˆä¸€æ¬¡ï¼‰æ–‡ä»¶ã€‚</p>\n</li>\n<li>\n<p><code>readFile(fileInputFormat, path, watchType, interval, pathFilter, typeInfo)</code> - è¿™æ˜¯å‰ä¸¤ä¸ªæ–¹æ³•å†…éƒ¨è°ƒç”¨çš„æ–¹æ³•ã€‚å®ƒæ ¹æ®ç»™å®šçš„ã€‚æ ¹æ®æ‰€æä¾›çš„ ï¼Œè¯¥æºå¯ä»¥å®šæœŸç›‘è§†ï¼ˆæ¯æ¯«ç§’ï¼‰æ–°æ•°æ®çš„è·¯å¾„ï¼ˆï¼‰ï¼Œæˆ–è€…å¤„ç†å½“å‰è·¯å¾„ä¸­çš„æ•°æ®å¹¶é€€å‡ºï¼ˆï¼‰ã€‚ä½¿ç”¨ ï¼Œç”¨æˆ·å¯ä»¥è¿›ä¸€æ­¥æ’é™¤æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ã€‚``</p>\n<p><em>å®ç°ï¼š</em></p>\n<p>åœ¨åº•å±‚ï¼ŒFlink å°†æ–‡ä»¶è¯»å–è¿‡ç¨‹æ‹†åˆ†ä¸ºä¸¤ä¸ªå­ä»»åŠ¡ï¼Œå³<em>ç›®å½•ç›‘æ§</em>å’Œ<em>æ•°æ®è¯»å–</em>ã€‚è¿™äº›å­ä»»åŠ¡ä¸­çš„æ¯ä¸€ä¸ªéƒ½ç”±ä¸€ä¸ªå•ç‹¬çš„å®ä½“å®ç°ã€‚ç›‘è§†ç”±å•ä¸ªéå¹¶è¡Œï¼ˆ<strong>å¹¶è¡Œåº¦</strong> = 1ï¼‰ä»»åŠ¡å®ç°ï¼Œè€Œè¯»å–ç”±å¹¶è¡Œè¿è¡Œçš„å¤šä¸ªä»»åŠ¡æ‰§è¡Œã€‚åè€…çš„å¹¶è¡Œåº¦ç­‰äºä½œä¸šå¹¶è¡Œåº¦ã€‚å•ä¸ªç›‘æ§ä»»åŠ¡çš„ä½œç”¨æ˜¯æ‰«æç›®å½•ï¼ˆå®šæœŸæˆ–ä»…æ‰«æä¸€æ¬¡ï¼Œå…·ä½“å–å†³äºç›®å½•ï¼‰ï¼Œæ‰¾åˆ°éœ€è¦å¤„ç†çš„æ–‡ä»¶ï¼Œå°†å…¶<em>æ‹†åˆ†</em>ï¼Œå¹¶å°†è¿™äº›æ‹†åˆ†åˆ†é…ç»™ä¸‹æ¸¸è¯»å–å™¨ã€‚è¯»è€…æ˜¯è¯»å–å®é™…æ•°æ®çš„äººã€‚æ¯ä¸ªæ‹†åˆ†åªèƒ½ç”±ä¸€ä¸ªè¯»å–å™¨è¯»å–ï¼Œè€Œä¸€ä¸ªè¯»å–å™¨å¯ä»¥é€ä¸ªè¯»å–å¤šä¸ªæ‹†åˆ†ã€‚</p>\n<p><em>é‡è¦æç¤ºï¼š</em></p>\n<ol>\n<li>å¦‚æœ è®¾ç½®ä¸º ï¼Œåˆ™åœ¨ä¿®æ”¹æ–‡ä»¶æ—¶ï¼Œå°†å®Œå…¨é‡æ–°å¤„ç†å…¶å†…å®¹ã€‚è¿™å¯èƒ½ä¼šç ´å â€œæ°å¥½ä¸€æ¬¡â€ çš„è¯­ä¹‰ï¼Œå› ä¸ºåœ¨æ–‡ä»¶æœ«å°¾é™„åŠ æ•°æ®å°†å¯¼è‡´é‡æ–°å¤„ç†å…¶<strong>æ‰€æœ‰</strong>å†…å®¹ã€‚</li>\n<li>å¦‚æœ è®¾ç½®ä¸º ï¼Œåˆ™æºæ‰«æ<strong>è·¯å¾„ä¸€æ¬¡</strong>å¹¶é€€å‡ºï¼Œè€Œæ— éœ€ç­‰å¾…è¯»å–å™¨å®Œæˆå¯¹æ–‡ä»¶å†…å®¹çš„è¯»å–ã€‚å½“ç„¶ï¼Œè¯»è€…å°†ç»§ç»­é˜…è¯»ï¼Œç›´åˆ°è¯»å–æ‰€æœ‰æ–‡ä»¶å†…å®¹ã€‚å…³é—­æºä¼šå¯¼è‡´åœ¨æ­¤ç‚¹ä¹‹åä¸å†æœ‰æ£€æŸ¥ç‚¹ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´èŠ‚ç‚¹æ•…éšœåçš„æ¢å¤é€Ÿåº¦å˜æ…¢ï¼Œå› ä¸ºä½œä¸šå°†ä»æœ€åä¸€ä¸ªæ£€æŸ¥ç‚¹æ¢å¤è¯»å–ã€‚</li>\n</ol>\n</li>\n</ul>\n<p>åŸºäºå¥—æ¥å­—ï¼š</p>\n<ul>\n<li><code>socketTextStream</code> - ä»å¥—æ¥å­—è¯»å–ã€‚å…ƒç´ å¯ä»¥ç”¨åˆ†éš”ç¬¦åˆ†éš”ã€‚</li>\n</ul>\n<p>åŸºäºé›†åˆï¼š</p>\n<ul>\n<li><code>fromCollection(Collection)</code> - ä» Java Java.util.Collection åˆ›å»ºæ•°æ®æµã€‚æ‰€æœ‰å…ƒç´  åœ¨é›†åˆä¸­å¿…é¡»å±äºåŒä¸€ç±»å‹ã€‚</li>\n<li><code>fromCollection(Iterator, Class)</code> - ä»è¿­ä»£å™¨åˆ›å»ºæ•°æ®æµã€‚è¯¥ç±»æŒ‡å®š è¿­ä»£å™¨è¿”å›çš„å…ƒç´ çš„æ•°æ®ç±»å‹ã€‚</li>\n<li><code>fromElements(T ...)</code> - ä»ç»™å®šçš„å¯¹è±¡åºåˆ—åˆ›å»ºæ•°æ®æµã€‚æ‰€æœ‰å¯¹è±¡éƒ½å¿…é¡»æ˜¯ ç›¸åŒç±»å‹ã€‚</li>\n<li><code>fromParallelCollection(SplittableIterator, Class)</code> - ä»è¿­ä»£å™¨åˆ›å»ºæ•°æ®æµï¼Œåœ¨ å¹³è¡Œã€‚è¯¥ç±»æŒ‡å®šè¿­ä»£å™¨è¿”å›çš„å…ƒç´ çš„æ•°æ®ç±»å‹ã€‚</li>\n<li><code>generateSequence(from, to)</code> - åœ¨ç»™å®šçš„æ—¶é—´é—´éš”å†…ç”Ÿæˆæ•°å­—åºåˆ—ï¼Œåœ¨ å¹³è¡Œã€‚</li>\n</ul>\n<p>ä¹ æƒ¯ï¼š</p>\n<ul>\n<li><code>addSource</code> - é™„åŠ æ–°çš„æºå‡½æ•°ã€æˆ–è€…è‡ªå®šä¹‰æ•°æ®æºã€‘ã€‚ä¾‹å¦‚ï¼Œè¦ä» Apache Kafka è¯»å–æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯<span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC9kb2NzL2Nvbm5lY3RvcnMvZGF0YXN0cmVhbS9vdmVydmlldy8=\">ï¼Œè¯·å‚é˜…è¿æ¥å™¨</span>ã€‚ <code>addSource(new FlinkKafkaConsumer&lt;&gt;(...))</code></li>\n</ul>\n<p><em>transfrom ç®—å­</em></p>\n<p>æœ‰å…³å¯ç”¨æµè½¬æ¢çš„æ¦‚è¿°ï¼Œè¯·å‚é˜…<span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC9kb2NzL2Rldi9kYXRhc3RyZWFtL29wZXJhdG9ycy9vdmVydmlldy8=\">è¿ç®—ç¬¦</span>ã€‚</p>\n<p><em>æ•°æ®æ¥æ”¶å™¨</em></p>\n<p>Flink è‡ªå¸¦äº†å¤šç§å†…ç½®çš„è¾“å‡ºæ ¼å¼ï¼Œè¿™äº›æ ¼å¼å°è£…åœ¨ æ•°æ®æµï¼š</p>\n<ul>\n<li><code>writeAsText()</code>  /  <code>TextOutputFormat</code> - å°†å…ƒç´ æŒ‰è¡Œå†™å…¥å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²æ˜¯ é€šè¿‡è°ƒç”¨æ¯ä¸ªå…ƒç´ çš„ <em>toStringï¼ˆï¼‰</em> æ–¹æ³•è·å¾—ã€‚</li>\n<li><code>writeAsCsv(...)</code>  /  <code>CsvOutputFormat</code> - å°†å…ƒç»„å†™å…¥é€—å·åˆ†éš”å€¼æ–‡ä»¶ã€‚è¡Œå’Œå­—æ®µ åˆ†éš”ç¬¦æ˜¯å¯é…ç½®çš„ã€‚æ¯ä¸ªå­—æ®µçš„å€¼æ¥è‡ªå¯¹è±¡çš„ <em>toStringï¼ˆï¼‰</em> æ–¹æ³•ã€‚</li>\n<li><code>print()</code>  /  <code>printToErr()</code> - æ‰“å° <em>toStringï¼ˆï¼‰</em> å€¼ æ ‡å‡†è¾“å‡º / æ ‡å‡†è¯¯å·®æµä¸Šçš„æ¯ä¸ªå…ƒç´ ã€‚æˆ–è€…ï¼Œå¯ä»¥æä¾›å‰ç¼€ ï¼ˆmsgï¼‰ï¼Œå³ åœ¨è¾“å‡ºä¹‹å‰ã€‚è¿™æœ‰åŠ©äºåŒºåˆ†ä¸åŒçš„<em>æ‰“å°</em>è°ƒç”¨ã€‚å¦‚æœå¹¶è¡Œåº¦ä¸º å¤§äº 1ï¼Œåˆ™è¾“å‡ºè¿˜å°†åœ¨å‰é¢åŠ ä¸Šç”Ÿæˆè¾“å‡ºçš„ä»»åŠ¡çš„æ ‡è¯†ç¬¦ã€‚</li>\n<li><code>writeUsingOutputFormat()</code>  /  <code>FileOutputFormat</code> - è‡ªå®šä¹‰æ–‡ä»¶è¾“å‡ºçš„æ–¹æ³•å’ŒåŸºç±»ã€‚æ”¯æŒ è‡ªå®šä¹‰å¯¹è±¡åˆ°å­—èŠ‚çš„è½¬æ¢ã€‚</li>\n<li><code>writeToSocket</code> - æ ¹æ® <code>SerializationSchema</code></li>\n<li><code>addSink</code> - è°ƒç”¨è‡ªå®šä¹‰æ¥æ”¶å™¨å‡½æ•°ã€‚Flink æ†ç»‘äº†å…¶ä»–ç³»ç»Ÿçš„è¿æ¥å™¨ï¼ˆä¾‹å¦‚ Apache Kafkaï¼‰ï¼Œä½œä¸ºæ¥æ”¶å™¨å‡½æ•°å®ç°ã€‚</li>\n</ul>\n<h3 id=\"ä¸‰-æ‰§è¡Œæ¨¡å¼\"><a class=\"markdownIt-Anchor\" href=\"#ä¸‰-æ‰§è¡Œæ¨¡å¼\">#</a> ä¸‰ã€æ‰§è¡Œæ¨¡å¼</h3>\n<p>DataStream API æ”¯æŒä¸åŒçš„è¿è¡Œæ—¶æ‰§è¡Œæ¨¡å¼ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„ç”¨ä¾‹éœ€è¦å’Œä½œä¸šç‰¹ç‚¹è¿›è¡Œé€‰æ‹©ã€‚</p>\n<p>DataStream API æœ‰ä¸€ç§â€ ç»å…¸ â€œçš„æ‰§è¡Œè¡Œä¸ºï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <code>æµï¼ˆSTREAMINGï¼‰</code> æ‰§è¡Œæ¨¡å¼ã€‚è¿™ç§æ¨¡å¼é€‚ç”¨äºéœ€è¦è¿ç»­å¢é‡å¤„ç†ï¼Œè€Œä¸”é¢„è®¡æ— é™æœŸä¿æŒåœ¨çº¿çš„æ— è¾¹ç•Œä½œä¸šã€‚</p>\n<p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ‰¹å¼æ‰§è¡Œæ¨¡å¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <code>æ‰¹ï¼ˆBATCHï¼‰</code> æ‰§è¡Œæ¨¡å¼ã€‚è¿™ç§æ‰§è¡Œä½œä¸šçš„æ–¹å¼æ›´å®¹æ˜“è®©äººè”æƒ³åˆ°æ‰¹å¤„ç†æ¡†æ¶ï¼Œæ¯”å¦‚ MapReduceã€‚è¿™ç§æ‰§è¡Œæ¨¡å¼é€‚ç”¨äºæœ‰ä¸€ä¸ªå·²çŸ¥çš„å›ºå®šè¾“å…¥ï¼Œè€Œä¸”ä¸ä¼šè¿ç»­è¿è¡Œçš„æœ‰è¾¹ç•Œä½œä¸šã€‚</p>\n<p>Apache Flink å¯¹æµå¤„ç†å’Œæ‰¹å¤„ç†ç»Ÿä¸€æ–¹æ³•ï¼Œæ„å‘³ç€æ— è®ºé…ç½®ä½•ç§æ‰§è¡Œæ¨¡å¼ï¼Œåœ¨æœ‰ç•Œè¾“å…¥ä¸Šæ‰§è¡Œçš„ DataStream åº”ç”¨éƒ½ä¼šäº§ç”Ÿç›¸åŒçš„<em>æœ€ç»ˆ</em> ç»“æœã€‚é‡è¦çš„æ˜¯è¦æ³¨æ„<em>æœ€ç»ˆ</em> åœ¨è¿™é‡Œæ˜¯ä»€ä¹ˆæ„æ€ï¼šä¸€ä¸ªåœ¨ <code>æµ</code> æ¨¡å¼æ‰§è¡Œçš„ä½œä¸šå¯èƒ½ä¼šäº§ç”Ÿå¢é‡æ›´æ–°ï¼ˆæƒ³æƒ³æ•°æ®åº“ä¸­çš„æ’å…¥ï¼ˆupsertï¼‰æ“ä½œï¼‰ï¼Œè€Œ <code>æ‰¹</code> ä½œä¸šåªåœ¨æœ€åäº§ç”Ÿä¸€ä¸ªæœ€ç»ˆç»“æœã€‚å°½ç®¡è®¡ç®—æ–¹æ³•ä¸åŒï¼Œåªè¦å‘ˆç°æ–¹å¼å¾—å½“ï¼Œæœ€ç»ˆç»“æœä¼šæ˜¯ç›¸åŒçš„ã€‚</p>\n<p>å¯ä»¥é€šè¿‡è®¾ç½®é…ç½®æ‰§è¡Œæ¨¡å¼ã€‚ æœ‰ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼š <code>execution.runtime-mode</code></p>\n<ul>\n<li><code>STREAMING</code> ï¼šç»å…¸ DataStream æ‰§è¡Œæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰</li>\n<li><code>BATCH</code> ï¼šåœ¨ DataStream API ä¸Šè¿›è¡Œæ‰¹å¤„ç†å¼æ‰§è¡Œ</li>\n<li><code>AUTOMATIC</code> ï¼šè®©ç³»ç»Ÿæ ¹æ®æºçš„æœ‰ç•Œæ€§æ¥å†³å®š</li>\n</ul>\n<p>è¿™å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œé…ç½® ï¼Œæˆ–è€… åœ¨åˆ›å»º / é…ç½® . <code>bin/flink run ...``StreamExecutionEnvironment</code></p>\n<p>ä»¥ä¸‹æ˜¯é€šè¿‡å‘½ä»¤è¡Œé…ç½®æ‰§è¡Œæ¨¡å¼çš„æ–¹æ³•ï¼š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ bin/flink run -Dexecution.runtime-mode<span class=\"token operator\">=</span>BATCH examples/streaming/WordCount.jar</pre></td></tr></table></figure><p>æ­¤ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•åœ¨ä»£ç ä¸­é…ç½®æ‰§è¡Œæ¨¡å¼ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">StreamExecutionEnvironment</span> env <span class=\"token operator\">=</span> <span class=\"token class-name\">StreamExecutionEnvironment</span><span class=\"token punctuation\">.</span><span class=\"token function\">getExecutionEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>env<span class=\"token punctuation\">.</span><span class=\"token function\">setRuntimeMode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RuntimeExecutionMode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BATCH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>æˆ‘ä»¬å»ºè®®ç”¨æˆ·<strong>ä¸è¦</strong>åœ¨ç¨‹åºä¸­è®¾ç½®è¿è¡Œæ—¶æ¨¡å¼ï¼Œè€Œæ˜¯ æäº¤åº”ç”¨ç¨‹åºæ—¶ä½¿ç”¨å‘½ä»¤è¡Œè¿›è¡Œè®¾ç½®ã€‚ä¿æŒ æ— éœ€é…ç½®åº”ç”¨ç¨‹åºä»£ç ï¼Œå³å¯å®ç°æ›´å¤§çš„çµæ´»æ€§ åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä»»ä½•æ‰§è¡Œæ¨¡å¼ä¸‹æ‰§è¡Œã€‚</p>\n</blockquote>\n<h3 id=\"å››-æ‰§è¡Œè¡Œä¸º\"><a class=\"markdownIt-Anchor\" href=\"#å››-æ‰§è¡Œè¡Œä¸º\">#</a> å››ã€æ‰§è¡Œè¡Œä¸º</h3>\n<h3 id=\"äº”-ä»»åŠ¡è°ƒåº¦ä¸ç½‘ç»œ-shuffle\"><a class=\"markdownIt-Anchor\" href=\"#äº”-ä»»åŠ¡è°ƒåº¦ä¸ç½‘ç»œ-shuffle\">#</a> äº”ã€ä»»åŠ¡è°ƒåº¦ä¸ç½‘ç»œ Shuffle</h3>\n<p>Flink ä½œä¸šç”±ä¸åŒçš„æ“ä½œç»„æˆï¼Œè¿™äº›æ“ä½œåœ¨æ•°æ®æµå›¾ä¸­è¿æ¥åœ¨ä¸€èµ·ã€‚ç³»ç»Ÿå†³å®šå¦‚ä½•åœ¨ä¸åŒçš„è¿›ç¨‹ / æœºå™¨ï¼ˆTaskManagerï¼‰ä¸Šè°ƒåº¦è¿™äº›æ“ä½œçš„æ‰§è¡Œï¼Œä»¥åŠå¦‚ä½•åœ¨å®ƒä»¬ä¹‹é—´ shuffle ï¼ˆå‘é€ï¼‰æ•°æ®ã€‚</p>\n<p>å°†å¤šä¸ªæ“ä½œ / ç®—å­é“¾æ¥åœ¨ä¸€èµ·çš„åŠŸèƒ½ç§°ä¸º<span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC96aC9kb2NzL2Rldi9kYXRhc3RyZWFtL29wZXJhdG9ycy9vdmVydmlldy8jdGFzay1jaGFpbmluZy1hbmQtcmVzb3VyY2UtZ3JvdXBz\">é“¾</span>ã€‚Flink ç§°ä¸€ä¸ªè°ƒåº¦å•ä½çš„ä¸€ç»„æˆ–å¤šä¸ªï¼ˆé“¾æ¥åœ¨ä¸€èµ·çš„ï¼‰ç®—å­ä¸ºä¸€ä¸ª <em>ä»»åŠ¡</em>ã€‚é€šå¸¸ï¼Œ<em>å­ä»»åŠ¡</em> ç”¨æ¥æŒ‡ä»£åœ¨å¤šä¸ª TaskManager ä¸Šå¹¶è¡Œè¿è¡Œçš„å•ä¸ªä»»åŠ¡å®ä¾‹ï¼Œä½†æˆ‘ä»¬åœ¨è¿™é‡Œåªä½¿ç”¨ <em>ä»»åŠ¡</em> (task) ä¸€è¯ã€‚</p>\n<p>ä»»åŠ¡è°ƒåº¦å’Œç½‘ç»œ shuffle å¯¹äº <code>æ‰¹</code> å’Œ <code>æµ</code> æ‰§è¡Œæ¨¡å¼çš„æ‰§è¡Œæ–¹å¼ä¸åŒã€‚è¿™ä¸»è¦æ˜¯ç”±äºåœ¨ <code>æ‰¹</code> æ‰§è¡Œæ¨¡å¼ä¸­ï¼Œå½“çŸ¥é“è¾“å…¥æ•°æ®æ˜¯æœ‰è¾¹ç•Œçš„æ—¶å€™ï¼Œ<strong>Flink å¯ä»¥ä½¿ç”¨æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„å’Œç®—æ³•</strong>ã€‚</p>\n<p>æˆ‘ä»¬å°†ç”¨è¿™ä¸ªä¾‹å­æ¥è§£é‡Šä»»åŠ¡è°ƒåº¦å’Œç½‘ç»œä¼ è¾“çš„å·®å¼‚ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">StreamExecutionEnvironment</span> env <span class=\"token operator\">=</span> <span class=\"token class-name\">StreamExecutionEnvironment</span><span class=\"token punctuation\">.</span><span class=\"token function\">getExecutionEnvironment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">DataStreamSource</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> source <span class=\"token operator\">=</span> env<span class=\"token punctuation\">.</span><span class=\"token function\">fromElements</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>source<span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"source\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"map1\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"map2\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">rebalance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"map3\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"map4\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">keyBy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> value<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"map5\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"map6\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token punctuation\">.</span><span class=\"token function\">sinkTo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sink\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>åŒ…å« 1-to-1 è¿æ¥æ¨¡å¼çš„æ“ä½œï¼Œæ¯”å¦‚  <code>map()</code> ã€  <code>flatMap()</code>  æˆ–  <code>filter()</code> ï¼Œå¯ä»¥ç›´æ¥å°†æ•°æ®è½¬å‘åˆ°ä¸‹ä¸€ä¸ªæ“ä½œï¼Œè¿™ä½¿å¾—è¿™äº›æ“ä½œå¯ä»¥è¢«é“¾æ¥åœ¨ä¸€èµ·ã€‚è¿™æ„å‘³ç€ Flink ä¸€èˆ¬ä¸ä¼šåœ¨ä»–ä»¬ä¹‹é—´æ’å…¥ç½‘ç»œ shuffleã€‚</p>\n<p>è€Œåƒ  <code>keyBy()</code>  æˆ–è€…  <code>rebalance()</code>  è¿™æ ·éœ€è¦åœ¨ä¸åŒçš„ä»»åŠ¡å¹¶è¡Œå®ä¾‹ä¹‹é—´è¿›è¡Œæ•°æ® shuffle çš„æ“ä½œï¼Œå°±ä¼šå¼•èµ·ç½‘ç»œ shuffleã€‚</p>\n<p>å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼ŒFlink ä¼šå°†æ“ä½œåˆ†ç»„ä¸ºè¿™äº›ä»»åŠ¡:</p>\n<ul>\n<li>ä»»åŠ¡ 1:  <code>source</code> ã€  <code>map1</code>  å’Œ  <code>map2</code></li>\n<li>ä»»åŠ¡ 2:  <code>map3</code>  å’Œ  <code>map4</code></li>\n<li>ä»»åŠ¡ 3:  <code>map5</code>  ã€  <code>map6</code>  å’Œ  <code>sink</code></li>\n</ul>\n<p>æˆ‘ä»¬åœ¨ä»»åŠ¡ 1 åˆ°ä»»åŠ¡ 2ã€ä»»åŠ¡ 2 åˆ°ä»»åŠ¡ 3 ä¹‹é—´å„æœ‰ä¸€æ¬¡ç½‘ç»œ shuffleã€‚è¿™æ˜¯è¯¥ä½œä¸šçš„å¯è§†åŒ–è¡¨ç¤ºï¼š</p>\n<img data-src=\"https://note.youdao.com/yws/api/personal/file/WEBdf4ba0a0f59f9b2a5218765dd5a35cfe?method=download&shareKey=e2599a9aa2a3734364c539c15ae47a50\">\n<h4 id=\"æµæ‰§è¡Œæ¨¡å¼\"><a class=\"markdownIt-Anchor\" href=\"#æµæ‰§è¡Œæ¨¡å¼\">#</a> æµæ‰§è¡Œæ¨¡å¼</h4>\n<p>åœ¨ <code>æµ</code> æ‰§è¡Œæ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä»»åŠ¡éœ€è¦ä¸€ç›´åœ¨çº¿ / è¿è¡Œã€‚è¿™ä½¿å¾— Flink å¯ä»¥é€šè¿‡æ•´ä¸ªç®¡é“ç«‹å³å¤„ç†æ–°çš„è®°å½•ï¼Œä»¥è¾¾åˆ°æˆ‘ä»¬éœ€è¦çš„è¿ç»­å’Œä½å»¶è¿Ÿçš„æµå¤„ç†ã€‚è¿™åŒæ ·æ„å‘³ç€åˆ†é…ç»™æŸä¸ªä½œä¸šçš„ TaskManagers éœ€è¦æœ‰è¶³å¤Ÿçš„èµ„æºæ¥åŒæ—¶è¿è¡Œæ‰€æœ‰çš„ä»»åŠ¡ã€‚</p>\n<p>ç½‘ç»œ shuffle æ˜¯ <em>æµæ°´çº¿</em> å¼çš„ï¼Œè¿™æ„å‘³ç€è®°å½•ä¼šç«‹å³å‘é€ç»™ä¸‹æ¸¸ä»»åŠ¡ï¼Œåœ¨ç½‘ç»œå±‚ä¸Šè¿›è¡Œä¸€äº›ç¼“å†²ã€‚åŒæ ·ï¼Œè¿™ä¹Ÿæ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºå½“å¤„ç†è¿ç»­çš„æ•°æ®æµæ—¶ï¼Œåœ¨ä»»åŠ¡ï¼ˆæˆ–ä»»åŠ¡ç®¡é“ï¼‰ä¹‹é—´æ²¡æœ‰å¯ä»¥å®ä½“åŒ–çš„è‡ªç„¶æ•°æ®ç‚¹ï¼ˆæ—¶é—´ç‚¹ï¼‰ã€‚è¿™ä¸ <code>æ‰¹</code> æ‰§è¡Œæ¨¡å¼å½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ï¼Œåœ¨ <code>æ‰¹</code> æ‰§è¡Œæ¨¡å¼ä¸‹ï¼Œä¸­é—´çš„ç»“æœå¯ä»¥è¢«å®ä½“åŒ–ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚</p>\n<h4 id=\"æ‰¹æ‰§è¡Œæ¨¡å¼\"><a class=\"markdownIt-Anchor\" href=\"#æ‰¹æ‰§è¡Œæ¨¡å¼\">#</a> æ‰¹æ‰§è¡Œæ¨¡å¼</h4>\n<p>åœ¨ <code>æ‰¹</code> æ‰§è¡Œæ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªä½œä¸šçš„ä»»åŠ¡å¯ä»¥è¢«åˆ†ç¦»æˆå¯ä»¥ä¸€ä¸ªæ¥ä¸€ä¸ªæ‰§è¡Œçš„é˜¶æ®µã€‚æˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ˜¯å› ä¸ºè¾“å…¥æ˜¯æœ‰è¾¹ç•Œçš„ï¼Œå› æ­¤ Flink å¯ä»¥åœ¨è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µä¹‹å‰å®Œå…¨å¤„ç†ç®¡é“ä¸­çš„ä¸€ä¸ªé˜¶æ®µã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå·¥ä½œä¼šæœ‰ä¸‰ä¸ªé˜¶æ®µï¼Œå¯¹åº”ç€è¢« shuffle ç•Œçº¿åˆ†å¼€çš„ä¸‰ä¸ªä»»åŠ¡ã€‚</p>\n<p>ä¸åŒäºä¸Šæ–‡æ‰€ä»‹ç»çš„ <code>æµ</code> æ¨¡å¼ç«‹å³å‘ä¸‹æ¸¸ä»»åŠ¡å‘é€è®°å½•ï¼Œåˆ†é˜¶æ®µå¤„ç†è¦æ±‚ Flink å°†ä»»åŠ¡çš„ä¸­é—´ç»“æœå®ä½“åŒ–åˆ°ä¸€äº›éæ°¸ä¹…å­˜å‚¨ä¸­ï¼Œè®©ä¸‹æ¸¸ä»»åŠ¡åœ¨ä¸Šæ¸¸ä»»åŠ¡å·²ç»ä¸‹çº¿åå†è¯»å–ã€‚è¿™å°†å¢åŠ å¤„ç†çš„å»¶è¿Ÿï¼Œä½†ä¹Ÿä¼šå¸¦æ¥å…¶ä»–æœ‰è¶£çš„ç‰¹æ€§ã€‚<strong>å…¶ä¸€ï¼Œè¿™å…è®¸ Flink åœ¨æ•…éšœå‘ç”Ÿæ—¶å›æº¯åˆ°æœ€æ–°çš„å¯ç”¨ç»“æœï¼Œè€Œä¸æ˜¯é‡æ–°å¯åŠ¨æ•´ä¸ªä»»åŠ¡ã€‚å…¶äºŒï¼Œ <code>æ‰¹</code> ä½œä¸šå¯ä»¥åœ¨æ›´å°‘çš„èµ„æºä¸Šæ‰§è¡Œï¼ˆå°± TaskManagers çš„å¯ç”¨æ§½è€Œè¨€ï¼‰ï¼Œå› ä¸ºç³»ç»Ÿå¯ä»¥ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°é¡ºåºæ‰§è¡Œä»»åŠ¡ã€‚</strong></p>\n<blockquote>\n<p>TaskManagers å°†è‡³å°‘åœ¨ä¸‹æ¸¸ä»»åŠ¡å¼€å§‹æ¶ˆè´¹å®ƒä»¬å‰ä¿ç•™ä¸­é—´ç»“æœï¼ˆä»æŠ€æœ¯ä¸Šè®²ï¼Œå®ƒä»¬å°†è¢«ä¿ç•™åˆ°æ¶ˆè´¹çš„<em>æµæ°´çº¿åŒºåŸŸ</em>äº§ç”Ÿå®ƒä»¬çš„è¾“å‡ºä¸ºæ­¢ï¼‰ã€‚åœ¨è¿™ä¹‹åï¼Œåªè¦ç©ºé—´å…è®¸ï¼Œå®ƒä»¬å°±ä¼šè¢«ä¿ç•™ï¼Œä»¥ä¾¿åœ¨å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å›æº¯åˆ°å‰é¢æ¶‰åŠçš„ç»“æœã€‚</p>\n</blockquote>\n<h3 id=\"å…­-äº‹ä»¶æ—¶é—´\"><a class=\"markdownIt-Anchor\" href=\"#å…­-äº‹ä»¶æ—¶é—´\">#</a> å…­ã€äº‹ä»¶æ—¶é—´</h3>\n<ul>\n<li>\n<p>** å¤„ç†æ—¶é—´ï¼š** å¤„ç†æ—¶é—´æ˜¯æŒ‡æœºå™¨çš„ç³»ç»Ÿæ—¶é—´ï¼Œå³æ‰§è¡Œç›¸åº”çš„æ“ä½œçš„æ—¶é—´ã€‚</p>\n<p>å½“æµå¼å¤„ç†ç¨‹åºåœ¨å¤„ç†æ—¶é—´ä¸Šè¿è¡Œæ—¶ï¼Œæ‰€æœ‰åŸºäºæ—¶é—´çš„æ“ä½œ ï¼ˆå¦‚æ—¶é—´çª—å£ï¼‰å°†ä½¿ç”¨è¿è¡Œå„è‡ªçš„è¿ç®—ç¬¦ã€‚æ¯å°æ—¶çš„å¤„ç†æ—¶é—´çª—å£å°†åŒ…æ‹¬æ‰€æœ‰ åœ¨ç³»ç»Ÿåˆ°è¾¾ç‰¹å®šæ“ä½œå‘˜çš„æ—¶é—´ä¹‹é—´çš„è®°å½• æ—¶é’Ÿæ˜¾ç¤ºæ•´ç‚¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå¼€å§‹è¿è¡Œ ä¸Šåˆ 9ï¼š15ï¼Œç¬¬ä¸€ä¸ªæ¯å°æ—¶å¤„ç†æ—¶é—´çª—å£å°†åŒ…æ‹¬äº‹ä»¶ åœ¨ä¸Šåˆ 9ï¼š15 è‡³ä¸Šåˆ 10ï¼š00 ä¹‹é—´å¤„ç†ï¼Œä¸‹ä¸€ä¸ªçª—å£å°†åŒ…å«äº‹ä»¶ åœ¨ä¸Šåˆ 10ï¼š00 è‡³ä¸Šåˆ 11ï¼š00 ä¹‹é—´å¤„ç†ï¼Œä¾æ­¤ç±»æ¨ã€‚</p>\n<p>å¤„ç†æ—¶é—´æ˜¯æœ€ç®€å•çš„æ—¶é—´æ¦‚å¿µï¼Œä¸éœ€è¦åè°ƒ åœ¨æµå’Œè®¡ç®—æœºä¹‹é—´ã€‚å®ƒæä¾›äº†æœ€ä½³æ€§èƒ½å’Œ æœ€ä½å»¶è¿Ÿã€‚ä½†æ˜¯ï¼Œåœ¨åˆ†å¸ƒå¼å’Œå¼‚æ­¥ç¯å¢ƒä¸­ å¤„ç†æ—¶é—´ä¸æä¾›ç¡®å®šæ€§ï¼Œå› ä¸ºå®ƒå®¹æ˜“å—åˆ° è®°å½•åˆ°è¾¾ç³»ç»Ÿçš„é€Ÿåº¦ï¼ˆä¾‹å¦‚ï¼Œä»æ¶ˆæ¯ queueï¼‰ï¼Œä»¥è®°å½•åœ¨ ç³»ç»Ÿï¼Œä»¥åŠä¸­æ–­ï¼ˆè®¡åˆ’æˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚</p>\n</li>\n<li>\n<p>** äº‹ä»¶æ—¶é—´ï¼š** äº‹ä»¶æ—¶é—´æ˜¯æ¯ä¸ªäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ å…¶ç”Ÿäº§è£…ç½®ã€‚æ­¤æ—¶é—´é€šå¸¸åµŒå…¥åœ¨è®°å½•ä¸­ åœ¨ä»–ä»¬è¿›å…¥ Flink ä¹‹å‰ï¼Œå¯ä»¥ä»ä¸­æå–<em>è¯¥äº‹ä»¶æ—¶é—´æˆ³</em> æ¯æ¡è®°å½•ã€‚åœ¨äº‹ä»¶æ—¶é—´ä¸­ï¼Œæ—¶é—´çš„è¿›å±•å–å†³äºæ•°æ®ï¼Œè€Œä¸æ˜¯ ä»»ä½•æŒ‚é’Ÿã€‚äº‹ä»¶æ—¶é—´ç¨‹åºå¿…é¡»æŒ‡å®šå¦‚ä½•ç”Ÿæˆ<em>äº‹ä»¶æ—¶é—´ æ°´å°</em>ï¼Œè¿™æ˜¯åœ¨äº‹ä»¶æ—¶é—´ä¸­å‘å‡ºè¿›åº¦ä¿¡å·çš„æœºåˆ¶ã€‚è¿™ æ°´å°æœºåˆ¶å°†åœ¨<span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC96aC9kb2NzL2NvbmNlcHRzL3RpbWUvI2V2ZW50LXRpbWUtYW5kLXdhdGVybWFya3M=\">åé¢</span>çš„éƒ¨åˆ†ä¸­ä»‹ç»ã€‚</p>\n<p>åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œäº‹ä»¶æ—¶é—´å¤„ç†å°†äº§ç”Ÿå®Œå…¨ä¸€è‡´çš„ç»“æœ å’Œç¡®å®šæ€§ç»“æœï¼Œæ— è®ºäº‹ä»¶ä½•æ—¶åˆ°è¾¾ï¼Œæˆ–è€…å…¶ è®¢è´­ã€‚ä½†æ˜¯ï¼Œé™¤éå·²çŸ¥äº‹ä»¶æŒ‰é¡ºåºåˆ°è¾¾ï¼ˆé€šè¿‡ timestampï¼‰ï¼Œäº‹ä»¶æ—¶é—´å¤„ç†åœ¨ç­‰å¾…æ—¶ä¼šäº§ç”Ÿä¸€äº›å»¶è¿Ÿ ä¹±åºäº‹ä»¶ã€‚ç”±äºåªèƒ½ç­‰å¾…æœ‰é™çš„æ—¶é—´ï¼Œè¿™é™åˆ¶äº†äº‹ä»¶æ—¶é—´åº”ç”¨ç¨‹åºçš„ç¡®å®šæ€§ã€‚</p>\n<p>å‡è®¾æ‰€æœ‰æ•°æ®éƒ½å·²åˆ°è¾¾ï¼Œåˆ™äº‹ä»¶æ—¶é—´æ“ä½œå°†è¡¨ç°ä¸º é¢„æœŸï¼Œå³ä½¿åœ¨ä½¿ç”¨ æ— åºæˆ–å»¶è¿Ÿäº‹ä»¶ï¼Œæˆ–é‡æ–°å¤„ç†å†å²æ•°æ®æ—¶ã€‚ä¾‹å¦‚ æ¯å°æ—¶äº‹ä»¶æ—¶é—´çª—å£å°†åŒ…å«æ‰¿è½½äº‹ä»¶çš„æ‰€æœ‰è®°å½• è½å…¥è¯¥å°æ—¶çš„æ—¶é—´æˆ³ï¼Œæ— è®ºå®ƒä»¬çš„é¡ºåºå¦‚ä½• åˆ°è¾¾ï¼Œæˆ–å½“å®ƒä»¬è¢«å¤„ç†æ—¶ã€‚</p>\n</li>\n<li>\n<p><strong>æ‘„å–æ—¶é—´ï¼š</strong></p>\n</li>\n</ul>\n",
            "tags": [
                "å¤§æ•°æ®",
                "Flink"
            ]
        },
        {
            "id": "http://example.com/2023/12/01/BaiduSyncdisk/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink/Flink%E7%9A%84%E6%90%AD%E5%BB%BA/",
            "url": "http://example.com/2023/12/01/BaiduSyncdisk/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink/Flink%E7%9A%84%E6%90%AD%E5%BB%BA/",
            "title": "Flinkçš„æ­å»º",
            "date_published": "2023-12-01T01:33:02.000Z",
            "content_html": "<h3 id=\"ä¸€-é›†ç¾¤è§„åˆ’\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€-é›†ç¾¤è§„åˆ’\">#</a> ä¸€ã€é›†ç¾¤è§„åˆ’</h3>\n<table>\n<thead>\n<tr>\n<th>nodev2001</th>\n<th>nodev2002</th>\n<th>nodev2003</th>\n<th>nodev2004</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>master</td>\n<td>worker</td>\n<td>worker</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p><strong><span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xOC96aC9kb2NzL2RlcGxveW1lbnQvamF2YV9jb21wYXRpYmlsaXR5Lw==\">é€‚é…çš„ java ç‰ˆæœ¬</span></strong></p>\n<h3 id=\"äºŒ-å®‰è£…æµç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#äºŒ-å®‰è£…æµç¨‹\">#</a> äºŒã€å®‰è£…æµç¨‹</h3>\n<p>å‰å¾€ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9mbGluay5hcGFjaGUub3JnL3poL2Rvd25sb2Fkcy5odG1s\">ä¸‹è½½é¡µé¢</span> è·å–å¯è¿è¡Œçš„è½¯ä»¶åŒ…ã€‚</p>\n<p>åœ¨ä¸‹è½½å®Œæœ€æ–°çš„å‘å¸ƒç‰ˆæœ¬åï¼Œå¤åˆ¶å‹ç¼©æ–‡ä»¶åˆ° master èŠ‚ç‚¹å¹¶è§£å‹ï¼š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> xzf flink-1.14.0-bin-scala_2.12.tgz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mv</span> flink-1.14.0-bin-scala_2.12.tgz /opt/module</pre></td></tr></table></figure><p>é…ç½® Flinkï¼š</p>\n<p>åœ¨è§£å‹å®Œæ–‡ä»¶åï¼Œç¼–è¾‘ <em>conf/flink-conf.yaml</em> æ–‡ä»¶æ¥ä¸ºé›†ç¾¤é…ç½® Flinkã€‚</p>\n<ol>\n<li>\n<p>è®¾ç½®  <code>jobmanager.rpc.address</code>  é…ç½®é¡¹æŒ‡å‘ master èŠ‚ç‚¹</p>\n</li>\n<li>\n<p>è®¾ç½®  <code>jobmanager.memory.process.size</code>  å’Œ  <code>taskmanager.memory.process.size</code>  é…ç½®é¡¹æ¥å®šä¹‰ Flink å…è®¸åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šåˆ†é…çš„æœ€å¤§å†…å­˜å€¼ã€‚</p>\n</li>\n<li>\n<p>å¦‚æœ worker èŠ‚ç‚¹ä¸Šæœ‰ä½ æƒ³åˆ†é…åˆ° Flink ç³»ç»Ÿçš„å¤šä½™å†…å­˜ï¼Œä½ å¯ä»¥åœ¨è¿™äº›ç‰¹å®šèŠ‚ç‚¹çš„ <em>conf/flink-conf.yaml</em> æ–‡ä»¶ä¸­é‡å†™  <code>taskmanager.memory.process.size</code>  æˆ–  <code>taskmanager.memory.flink.size</code>  çš„é»˜è®¤å€¼ã€‚s</p>\n</li>\n<li>\n<p>ç¼–è¾‘æ–‡ä»¶ <em>conf/masters</em> å¹¶è¾“å…¥ master èŠ‚ç‚¹çš„ IP æˆ–ä¸»æœºåã€‚</p>\n</li>\n<li>\n<p>ç¼–è¾‘æ–‡ä»¶ <em>conf/workers</em> å¹¶è¾“å…¥æ¯ä¸ª worker èŠ‚ç‚¹çš„ IP æˆ–ä¸»æœºåã€‚</p>\n</li>\n<li>\n<p>Flink ç›®å½•å¤åˆ¶åˆ°æ¯ä¸ª worker èŠ‚ç‚¹ä¸Šã€‚</p>\n</li>\n<li>\n<p><strong>å‚è€ƒ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC96aC9kb2NzL2RlcGxveW1lbnQvY29uZmlnLw==\">é…ç½®å‚æ•°é¡µé¢</span> è·å–æ›´å¤šç»†èŠ‚ä»¥åŠé¢å¤–çš„é…ç½®é¡¹ã€‚</strong></p>\n</li>\n<li>\n<p>ç‰¹åˆ«åœ°ï¼Œ</p>\n<ul>\n<li>æ¯ä¸ª JobManager çš„å¯ç”¨å†…å­˜å€¼ï¼ˆ <code>jobmanager.memory.process.size</code> ï¼‰ï¼Œ</li>\n<li>æ¯ä¸ª TaskManager çš„å¯ç”¨å†…å­˜å€¼ ï¼ˆ <code>taskmanager.memory.process.size</code> ï¼Œå¹¶æ£€æŸ¥ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC96aC9kb2NzL2RlcGxveW1lbnQvbWVtb3J5L21lbV90dW5pbmcvI2NvbmZpZ3VyZS1tZW1vcnktZm9yLXN0YW5kYWxvbmUtZGVwbG95bWVudA==\">å†…å­˜è°ƒä¼˜æŒ‡å—</span>ï¼‰ï¼Œ</li>\n<li>æ¯å°æœºå™¨çš„å¯ç”¨ CPU æ•°ï¼ˆ <code>taskmanager.numberOfTaskSlots</code> ï¼‰ï¼Œ</li>\n<li>é›†ç¾¤ä¸­æ‰€æœ‰ CPU æ•°ï¼ˆ <code>parallelism.default</code> ï¼‰å’Œ</li>\n<li>ä¸´æ—¶ç›®å½•ï¼ˆ <code>io.tmp.dirs</code> ï¼‰</li>\n</ul>\n<p>çš„å€¼éƒ½æ˜¯éå¸¸é‡è¦çš„é…ç½®é¡¹ã€‚</p>\n</li>\n</ol>\n<h3 id=\"ä¸‰-å¯åŠ¨flinké›†ç¾¤\"><a class=\"markdownIt-Anchor\" href=\"#ä¸‰-å¯åŠ¨flinké›†ç¾¤\">#</a> ä¸‰ã€å¯åŠ¨ Flink é›†ç¾¤</h3>\n<ol>\n<li>æœ¬åœ°èŠ‚ç‚¹å¯åŠ¨äº†ä¸€ä¸ª JobManager å¹¶é€šè¿‡ SSH è¿æ¥åˆ° <em>workers</em> æ–‡ä»¶ä¸­æ‰€æœ‰çš„ worker èŠ‚ç‚¹ï¼Œmaster èŠ‚ç‚¹çš„ flink ç›®å½•ä¸‹</li>\n</ol>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bin/start-cluster.sh</pre></td></tr></table></figure><ol start=\"2\">\n<li>\n<p>å…³é—­ Flinkï¼Œè¿™é‡ŒåŒæ ·æœ‰ä¸€ä¸ª  <code>stop-cluster.sh</code>  è„šæœ¬ã€‚</p>\n</li>\n<li>\n<p>ä¸ºé›†ç¾¤æ·»åŠ  JobManager<sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup>/TaskManager<sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup> å®ä¾‹</p>\n<p><strong>æ·»åŠ  JobManager</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bin/jobmanager.sh <span class=\"token punctuation\">((</span>start<span class=\"token operator\">|</span>start-foreground<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>host<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>webui-port<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>stop-all</pre></td></tr></table></figure><p><strong>æ·»åŠ  TaskManager</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bin/taskmanager.sh start<span class=\"token operator\">|</span>start-foreground<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>stop-all</pre></td></tr></table></figure><p>ç¡®ä¿åœ¨ä½ æƒ³å¯åŠ¨ / å…³é—­ç›¸åº”å®ä¾‹çš„ä¸»æœºä¸Šæ‰§è¡Œè¿™äº›è„šæœ¬ã€‚</p>\n</li>\n</ol>\n<h3 id=\"å››-ä½¿ç”¨yarnç®¡ç†é›†ç¾¤\"><a class=\"markdownIt-Anchor\" href=\"#å››-ä½¿ç”¨yarnç®¡ç†é›†ç¾¤\">#</a> å››ã€ä½¿ç”¨ Yarn ç®¡ç†é›†ç¾¤</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC9kb2NzL2RlcGxveW1lbnQvb3ZlcnZpZXcvI2FwcGxpY2F0aW9uLW1vZGU=\">Flink çš„ 3 ç§éƒ¨ç½²æ¨¡å¼</span></p>\n<ol>\n<li>åº”ç”¨ç¨‹åºæ¨¡å¼ï¼š</li>\n<li>ä½œä¸šæ¨¡å¼ï¼š<em>Per-Job</em> æ¨¡å¼ä½¿ç”¨å¯ç”¨çš„èµ„æºæä¾›ç¨‹åº æ¡†æ¶ï¼ˆä¾‹å¦‚ YARNã€Kubernetesï¼‰ä¸ºæ¯ä¸ªæäº¤çš„ä½œä¸šå¯åŠ¨ä¸€ä¸ªé›†ç¾¤ã€‚æ­¤ç¾¤é›†å¯ç”¨äº åªæœ‰é‚£ä»½å·¥ä½œã€‚ä½œä¸šå®Œæˆåï¼Œç¾¤é›†å°†è¢«æ‹†é™¤ï¼Œä»»ä½•å»¶è¿Ÿçš„èµ„æºï¼ˆæ–‡ä»¶ç­‰ï¼‰éƒ½ä¼šè¢«æ‹†é™¤ æ¸…é™¤äº†ã€‚</li>\n<li>ä¼šè¯æ¨¡å¼ï¼šå¤šä¸ª flink Application å‘åŒä¸€ä¸ª JobManager æäº¤ï¼Œç›¸äº’ä¹‹é—´ç«äº‰èµ„æºï¼›å¥½å¤„ï¼šä¸éœ€è¦é‡å¤çš„å¯åŠ¨é›†ç¾¤ã€‚</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>éƒ¨ç½²æ¨¡å¼</th>\n<th>å¯åŠ¨é›†ç¾¤</th>\n<th>èµ„æºéš”ç¦»</th>\n<th>JM æ•°é‡</th>\n<th>åº”ç”¨ç¨‹åºçš„æ–¹æ³•</th>\n<th>é€‚åˆæƒ…å†µ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>åº”ç”¨ç¨‹åºæ¨¡å¼</td>\n<td>1 æ¬¡</td>\n<td>éš”ç¦»</td>\n<td>1/per job</td>\n<td>jM</td>\n<td>ã€ä½œä¸šæ¨¡å¼ï¼Œä¼šè¯æ¨¡å¼æŠ˜ä¸­ã€‘</td>\n</tr>\n<tr>\n<td>ä½œä¸šæ¨¡å¼</td>\n<td>1/per job</td>\n<td>éš”ç¦»</td>\n<td>1/per job</td>\n<td>client</td>\n<td>é•¿æ—¶é—´è¿è¡Œçš„ä½œä¸š</td>\n</tr>\n<tr>\n<td>ä¼šè¯æ¨¡å¼</td>\n<td>1 æ¬¡</td>\n<td>ä¸éš”ç¦»</td>\n<td>1</td>\n<td>client</td>\n<td>ä½å»¶è¿Ÿï¼Œè¿è¡Œæ—¶é—´çŸ­</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"äº”-ä½¿ç”¨é—®é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#äº”-ä½¿ç”¨é—®é¢˜\">#</a> äº”ã€ä½¿ç”¨é—®é¢˜</h3>\n<ol>\n<li>ä¼šè¯æ¨¡å¼ï¼Œper-job æ¨¡å¼å¯åŠ¨ä¸¤ä¸ªä»»åŠ¡ä¼šå¤±è´¥</li>\n</ol>\n<h3 id=\"è„šæ³¨\"><a class=\"markdownIt-Anchor\" href=\"#è„šæ³¨\">#</a> è„šæ³¨</h3>\n<p><em>JobManager</em> å…·æœ‰è®¸å¤šä¸åè°ƒ Flink åº”ç”¨ç¨‹åºçš„åˆ†å¸ƒå¼æ‰§è¡Œæœ‰å…³çš„èŒè´£ï¼šå®ƒå†³å®šä½•æ—¶è°ƒåº¦ä¸‹ä¸€ä¸ª taskï¼ˆæˆ–ä¸€ç»„ taskï¼‰ã€å¯¹å®Œæˆçš„ task æˆ–æ‰§è¡Œå¤±è´¥åšå‡ºååº”ã€åè°ƒ checkpointã€å¹¶ä¸”åè°ƒä»å¤±è´¥ä¸­æ¢å¤ç­‰ç­‰ã€‚è¿™ä¸ªè¿›ç¨‹ç”±ä¸‰ä¸ªä¸åŒçš„ç»„ä»¶ç»„æˆï¼š</p>\n<ul>\n<li>\n<p><strong>ResourceManager</strong></p>\n<p><em>ResourceManager</em> è´Ÿè´£ Flink é›†ç¾¤ä¸­çš„èµ„æºæä¾›ã€å›æ”¶ã€åˆ†é… - å®ƒç®¡ç† <strong>task slots</strong>ï¼Œè¿™æ˜¯ Flink é›†ç¾¤ä¸­èµ„æºè°ƒåº¦çš„å•ä½ï¼ˆè¯·å‚è€ƒ<span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC96aC9kb2NzL2NvbmNlcHRzL2ZsaW5rLWFyY2hpdGVjdHVyZS8jdGFza21hbmFnZXJz\"> TaskManagers</span>ï¼‰ã€‚Flink ä¸ºä¸åŒçš„ç¯å¢ƒå’Œèµ„æºæä¾›è€…ï¼ˆä¾‹å¦‚ YARNã€Kubernetes å’Œ standalone éƒ¨ç½²ï¼‰å®ç°äº†å¯¹åº”çš„ ResourceManagerã€‚åœ¨ standalone è®¾ç½®ä¸­ï¼ŒResourceManager åªèƒ½åˆ†é…å¯ç”¨ TaskManager çš„ slotsï¼Œè€Œä¸èƒ½è‡ªè¡Œå¯åŠ¨æ–°çš„ TaskManagerã€‚</p>\n</li>\n<li>\n<p><strong>Dispatcher</strong></p>\n<p><em>Dispatcher</em> æä¾›äº†ä¸€ä¸ª REST æ¥å£ï¼Œç”¨æ¥æäº¤ Flink åº”ç”¨ç¨‹åºæ‰§è¡Œï¼Œå¹¶ä¸ºæ¯ä¸ªæäº¤çš„ä½œä¸šå¯åŠ¨ä¸€ä¸ªæ–°çš„ JobMasterã€‚å®ƒè¿˜è¿è¡Œ Flink WebUI ç”¨æ¥æä¾›ä½œä¸šæ‰§è¡Œä¿¡æ¯ã€‚</p>\n</li>\n<li>\n<p><strong>JobMaster</strong></p>\n<p><em>JobMaster</em> è´Ÿè´£ç®¡ç†å•ä¸ª<span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC96aC9kb2NzL2NvbmNlcHRzL2dsb3NzYXJ5LyNsb2dpY2FsLWdyYXBo\"> JobGraph</span> çš„æ‰§è¡Œã€‚Flink é›†ç¾¤ä¸­å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªä½œä¸šï¼Œæ¯ä¸ªä½œä¸šéƒ½æœ‰è‡ªå·±çš„ JobMasterã€‚</p>\n</li>\n</ul>\n<p>å§‹ç»ˆè‡³å°‘æœ‰ä¸€ä¸ª JobManagerã€‚é«˜å¯ç”¨ï¼ˆHAï¼‰è®¾ç½®ä¸­å¯èƒ½æœ‰å¤šä¸ª JobManagerï¼Œå…¶ä¸­ä¸€ä¸ªå§‹ç»ˆæ˜¯ <em>leader</em>ï¼Œå…¶ä»–çš„åˆ™æ˜¯ <em>standby</em>ï¼ˆè¯·å‚è€ƒ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC96aC9kb2NzL2RlcGxveW1lbnQvaGEvb3ZlcnZpZXcv\">é«˜å¯ç”¨ï¼ˆHAï¼‰</span>ï¼‰ã€‚</p>\n<p><em>TaskManager</em>ï¼ˆä¹Ÿç§°ä¸º <em>worker</em>ï¼‰æ‰§è¡Œä½œä¸šæµçš„ taskï¼Œå¹¶ä¸”ç¼“å­˜å’Œäº¤æ¢æ•°æ®æµã€‚</p>\n<p>å¿…é¡»å§‹ç»ˆè‡³å°‘æœ‰ä¸€ä¸ª TaskManagerã€‚åœ¨ TaskManager ä¸­èµ„æºè°ƒåº¦çš„æœ€å°å•ä½æ˜¯ task <em>slot</em>ã€‚TaskManager ä¸­ task slot çš„æ•°é‡è¡¨ç¤ºå¹¶å‘å¤„ç† task çš„æ•°é‡ã€‚è¯·æ³¨æ„ä¸€ä¸ª task slot ä¸­å¯ä»¥æ‰§è¡Œå¤šä¸ªç®—å­ï¼ˆè¯·å‚è€ƒ<span class=\"exturl\" data-url=\"aHR0cHM6Ly9uaWdodGxpZXMuYXBhY2hlLm9yZy9mbGluay9mbGluay1kb2NzLXJlbGVhc2UtMS4xNC96aC9kb2NzL2NvbmNlcHRzL2ZsaW5rLWFyY2hpdGVjdHVyZS8jdGFza3MtYW5kLW9wZXJhdG9yLWNoYWlucw==\"> Tasks å’Œç®—å­é“¾</span>ï¼‰ã€‚</p>\n<hr class=\"footnotes-sep\">\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>JobManager <a href=\"#fnref1\" class=\"footnote-backref\">â†©ï¸</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p>TaskManagers <a href=\"#fnref2\" class=\"footnote-backref\">â†©ï¸</a></p>\n</li>\n</ol>\n</section>\n",
            "tags": [
                "å¤§æ•°æ®",
                "Flink"
            ]
        }
    ]
}